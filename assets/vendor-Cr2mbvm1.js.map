{"version":3,"file":"vendor-Cr2mbvm1.js","sources":["../../src/core/constants.js","../../src/core/logger.js","../../src/editors/base.js","../../src/editors/codemirror.js"],"sourcesContent":["/**\r\n * Application-wide constants\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\n\r\n// Execution timeouts\r\nexport const DEFAULT_TIMEOUT_MS = 4000;\r\nexport const NETWORK_TIMEOUT_MS = 5000;\r\nexport const TEMPLATE_LOAD_TIMEOUT_MS = 5000;\r\n\r\n// UI dimensions\r\nexport const MIN_LEFT_PANE_WIDTH = 320;\r\nexport const MIN_RIGHT_PANE_WIDTH = 420;\r\nexport const MIN_CONSOLE_HEIGHT = 100;\r\nexport const MIN_PREVIEW_HEIGHT = 100;\r\nexport const RESIZE_HANDLE_WIDTH = 5;\r\nexport const VERTICAL_RESIZE_HANDLE_HEIGHT = 8;\r\n\r\n// Storage keys\r\nexport const DEFAULT_STORAGE_KEY = 'js-sandbox-code';\r\n\r\n// Log levels\r\nexport const LOG_LEVELS = {\r\n  ERROR: 0,\r\n  WARN: 1,\r\n  INFO: 2,\r\n  DEBUG: 3,\r\n  TRACE: 4\r\n};\r\n\r\n// Default log level\r\nexport const DEFAULT_LOG_LEVEL = 'info';\r\n\r\n// Mobile breakpoint\r\nexport const MOBILE_BREAKPOINT = 768;\r\n\r\n/**\r\n * Gets the base path from the current document base or defaults to root\r\n * @returns {string} The base path (e.g., '/sandboxjs/' or '/')\r\n */\r\nfunction getBasePath() {\r\n  // Check if there's a base tag\r\n  const baseTag = document.querySelector('base');\r\n  if (baseTag && baseTag.href) {\r\n    const url = new URL(baseTag.href);\r\n    return url.pathname;\r\n  }\r\n  \r\n  // Fallback: detect from current path\r\n  const path = window.location.pathname;\r\n  // If path includes /sandboxjs/, use that as base\r\n  if (path.includes('/sandboxjs/')) {\r\n    return '/sandboxjs/';\r\n  }\r\n  \r\n  return '/';\r\n}\r\n\r\n// Examples path - dynamically determined based on base path\r\nexport const DEFAULT_EXAMPLES_PATH = getBasePath() + 'examples';\r\n\r\n// Template path - relative path works in both dev and production\r\nexport const DEFAULT_TEMPLATE_PATH = './src/ui/sandbox.html';\r\n\r\n// Event names\r\nexport const EVENTS = {\r\n  // Initialization\r\n  INIT_START: 'init:start',\r\n  INIT_COMPLETE: 'init:complete',\r\n  INIT_ERROR: 'init:error',\r\n  \r\n  // Code events\r\n  CODE_CHANGE: 'code:change',\r\n  CODE_LOAD: 'code:load',\r\n  CODE_VALIDATE: 'code:validate',\r\n  CODE_EXECUTE_START: 'code:execute:start',\r\n  CODE_EXECUTE_COMPLETE: 'code:execute:complete',\r\n  CODE_EXECUTE_TIMEOUT: 'code:execute:timeout',\r\n  \r\n  // Console events\r\n  CONSOLE_MESSAGE: 'console:message',\r\n  CONSOLE_CLEAR: 'console:clear',\r\n  \r\n  // Sandbox events\r\n  SANDBOX_RESET: 'sandbox:reset',\r\n  \r\n  // Status events\r\n  STATUS_CHANGE: 'status:change',\r\n\r\n  // Theme events\r\n  THEME_LOAD_START: 'theme:load:start',\r\n  THEME_LOAD_COMPLETE: 'theme:load:complete',\r\n  THEME_CHANGE: 'theme:change',\r\n  THEME_READY: 'theme:ready',\r\n  \r\n  // Editor events\r\n  EDITOR_READY: 'editor:ready',\r\n  \r\n  // Example events\r\n  EXAMPLE_LOAD: 'example:load',\r\n  EXAMPLE_LOADED: 'example:loaded',\r\n  EXAMPLE_ERROR: 'example:error',\r\n  \r\n  // Pane events\r\n  PANES_RESIZED: 'panes:resized',\r\n  PANES_RESIZED_VERTICAL: 'panes:resized:vertical',\r\n  \r\n  // Destroy\r\n  DESTROY: 'destroy'\r\n};\r\n\r\n// Status messages\r\nexport const STATUS_MESSAGES = {\r\n  executing: 'Executingâ€¦',\r\n  completed: 'Completed',\r\n  timeout: 'Timeout exceeded',\r\n  reset: 'Sandbox reset',\r\n  cleared: 'Console cleared'\r\n};\r\n\r\n// Security\r\nexport const CRYPTO_ARRAY_SIZE = 2;\r\n\r\n// Template markers\r\nexport const TEMPLATE_MARKERS = {\r\n  SECRET: '{{SECRET}}',\r\n  USER_CODE: '{{USER_CODE}}'\r\n};\r\n","import { LOG_LEVELS, DEFAULT_LOG_LEVEL } from './constants.js';\r\n\r\n/**\r\n * Global logging filter manager for enabling/disabling specific components\r\n */\r\nclass LoggingManager {\r\n  constructor() {\r\n    this.allowedComponents = new Set();\r\n    this.globalEnabled = true;\r\n    this.allowAll = false;\r\n\r\n    // Try to load from localStorage\r\n    this.loadFromStorage();\r\n  }\r\n\r\n  /**\r\n   * Enables logging for specific components\r\n   * @param {...string} components - Component names to enable\r\n   */\r\n  enable(...components) {\r\n    components.forEach(comp => this.allowedComponents.add(comp.toLowerCase()));\r\n    this.saveToStorage();\r\n    console.log('ðŸ”§ Logging enabled for:', components.join(', '));\r\n  }\r\n\r\n  /**\r\n   * Disables logging for specific components\r\n   * @param {...string} components - Component names to disable\r\n   */\r\n  disable(...components) {\r\n    components.forEach(comp => this.allowedComponents.delete(comp.toLowerCase()));\r\n    this.saveToStorage();\r\n    console.log('ðŸ”§ Logging disabled for:', components.join(', '));\r\n  }\r\n\r\n  /**\r\n   * Enables logging for all components\r\n   */\r\n  enableAll() {\r\n    this.allowAll = true;\r\n    this.saveToStorage();\r\n    console.log('ðŸ”§ Logging enabled for ALL components');\r\n  }\r\n\r\n  /**\r\n   * Disables logging for all components except errors\r\n   */\r\n  disableAll() {\r\n    this.allowAll = false;\r\n    this.allowedComponents.clear();\r\n    this.saveToStorage();\r\n    console.log('ðŸ”§ Logging disabled for ALL components (errors still show)');\r\n  }\r\n\r\n  /**\r\n   * Shows current logging status\r\n   */\r\n  status() {\r\n    console.log('ðŸ”§ Logging Status:');\r\n    console.log('  Global enabled:', this.globalEnabled);\r\n    console.log('  Allow all:', this.allowAll);\r\n    console.log('  Enabled components:', Array.from(this.allowedComponents).join(', ') || 'none');\r\n  }\r\n\r\n  /**\r\n   * Lists available components that have loggers\r\n   */\r\n  listComponents() {\r\n    console.log('ðŸ”§ Available components to filter:');\r\n    const components = Array.from(this.registeredComponents || []).sort();\r\n    components.forEach(comp => {\r\n      const enabled = this.isComponentEnabled(comp);\r\n      console.log(`  ${enabled ? 'âœ…' : 'âŒ'} ${comp}`);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Checks if a component should log\r\n   * @param {string} component - Component name\r\n   * @returns {boolean} True if component should log\r\n   */\r\n  isComponentEnabled(component) {\r\n    if (!this.globalEnabled) return false;\r\n    if (this.allowAll) return true;\r\n    return this.allowedComponents.has(component.toLowerCase());\r\n  }\r\n\r\n  /**\r\n   * Registers a component for tracking\r\n   * @param {string} component - Component name\r\n   */\r\n  registerComponent(component) {\r\n    if (!this.registeredComponents) this.registeredComponents = new Set();\r\n    this.registeredComponents.add(component);\r\n  }\r\n\r\n  /**\r\n   * Saves filter state to localStorage\r\n   */\r\n  saveToStorage() {\r\n    try {\r\n      const state = {\r\n        allowedComponents: Array.from(this.allowedComponents),\r\n        allowAll: this.allowAll,\r\n        globalEnabled: this.globalEnabled\r\n      };\r\n      localStorage.setItem('sandbox_logging_filters', JSON.stringify(state));\r\n    } catch (e) {\r\n      // Ignore localStorage errors\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Loads filter state from localStorage\r\n   */\r\n  loadFromStorage() {\r\n    try {\r\n      const state = JSON.parse(localStorage.getItem('sandbox_logging_filters') || '{}');\r\n      this.allowedComponents = new Set(state.allowedComponents || []);\r\n      this.allowAll = state.allowAll || false;\r\n      this.globalEnabled = state.globalEnabled !== false;\r\n\r\n      // If no saved state exists, set up sensible defaults for theme work\r\n      if (!localStorage.getItem('sandbox_logging_filters')) {\r\n        this.allowedComponents = new Set(['themeswitcher', 'codemirroreditor', 'editoradapter']);\r\n      }\r\n    } catch (e) {\r\n      // Ignore localStorage errors, use defaults\r\n      this.allowedComponents = new Set(['themeswitcher', 'codemirroreditor', 'editoradapter']);\r\n    }\r\n  }\r\n}\r\n\r\n// Global instance\r\nconst loggingManager = new LoggingManager();\r\n\r\n// Expose to window for easy console access\r\nif (typeof window !== 'undefined') {\r\n  window.logFilter = {\r\n    enable: (...components) => loggingManager.enable(...components),\r\n    disable: (...components) => loggingManager.disable(...components),\r\n    enableAll: () => loggingManager.enableAll(),\r\n    disableAll: () => loggingManager.disableAll(),\r\n    status: () => loggingManager.status(),\r\n    list: () => loggingManager.listComponents()\r\n  };\r\n}\r\n\r\n/**\r\n * Configurable logging interface with level-based filtering and prefixes\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\nexport class Logger {\r\n  /**\r\n   * Creates a new Logger instance\r\n   * @param {Object} options - Logger configuration options\r\n   * @param {boolean} [options.enabled=true] - Whether logging is enabled\r\n   * @param {string} [options.level='info'] - Log level (error, warn, info, debug, trace)\r\n   * @param {string} [options.prefix=''] - Prefix to add to all log messages\r\n   * @param {boolean} [options.redactSecrets=false] - Whether to redact potential secrets\r\n   */\r\n  constructor(options = {}) {\r\n    this.enabled = options.enabled !== false;\r\n    this.level = options.level || DEFAULT_LOG_LEVEL;\r\n    this.prefix = options.prefix || '';\r\n    this.component = this.prefix; // Use prefix as component name for filtering\r\n    this.redactSecrets = options.redactSecrets || false;\r\n    this.currentLevel = LOG_LEVELS[this.level.toUpperCase()] ?? LOG_LEVELS.INFO;\r\n\r\n    // Register this component with the global manager\r\n    if (this.component) {\r\n      loggingManager.registerComponent(this.component);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Checks if a message should be logged based on current level, enabled state, and component filter\r\n   * @param {string} level - The log level to check\r\n   * @returns {boolean} True if the message should be logged\r\n   */\r\n  shouldLog(level) {\r\n    // Always allow errors to pass through\r\n    if (level.toUpperCase() === 'ERROR') {\r\n      return this.enabled && LOG_LEVELS[level.toUpperCase()] <= this.currentLevel;\r\n    }\r\n\r\n    // Check if this component is allowed to log\r\n    const componentAllowed = !this.component || loggingManager.isComponentEnabled(this.component);\r\n\r\n    return this.enabled &&\r\n           componentAllowed &&\r\n           LOG_LEVELS[level.toUpperCase()] <= this.currentLevel;\r\n  }\r\n\r\n  /**\r\n   * Redacts potential secrets from arguments\r\n   * @param {Array} args - Arguments to redact\r\n   * @returns {Array} Redacted arguments\r\n   */\r\n  redactArgs(args) {\r\n    if (!this.redactSecrets) return args;\r\n    \r\n    return args.map(arg => {\r\n      if (typeof arg === 'string') {\r\n        // Redact anything that looks like a token/secret (alphanumeric strings > 20 chars)\r\n        return arg.replace(/\\b[a-zA-Z0-9]{20,}\\b/g, '[REDACTED]');\r\n      }\r\n      return arg;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Formats a message with prefix\r\n   * @param {string} message - The message to format\r\n   * @param {...any} args - Additional arguments\r\n   * @returns {Array} Formatted message array\r\n   */\r\n  formatMessage(message, ...args) {\r\n    const prefix = this.prefix ? `[${this.prefix}] ` : '';\r\n    const redactedArgs = this.redactArgs(args);\r\n    return [prefix + message, ...redactedArgs];\r\n  }\r\n\r\n  /**\r\n   * Logs an error message\r\n   * @param {string} message - The error message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  error(message, ...args) {\r\n    if (this.shouldLog('error')) {\r\n      console.error(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a warning message\r\n   * @param {string} message - The warning message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  warn(message, ...args) {\r\n    if (this.shouldLog('warn')) {\r\n      console.warn(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs an info message\r\n   * @param {string} message - The info message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  info(message, ...args) {\r\n    if (this.shouldLog('info')) {\r\n      console.info(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a general message\r\n   * @param {string} message - The message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  log(message, ...args) {\r\n    if (this.shouldLog('info')) {\r\n      console.log(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a debug message\r\n   * @param {string} message - The debug message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  debug(message, ...args) {\r\n    if (this.shouldLog('debug')) {\r\n      console.debug(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a trace message (with secret redaction by default)\r\n   * @param {string} message - The trace message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  trace(message, ...args) {\r\n    if (this.shouldLog('trace')) {\r\n      // Always redact for trace logs to avoid leaking secrets\r\n      const wasRedacting = this.redactSecrets;\r\n      this.redactSecrets = true;\r\n      console.trace(...this.formatMessage(message, ...args));\r\n      this.redactSecrets = wasRedacting;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a table of data\r\n   * @param {any} data - The data to display in table format\r\n   * @param {Array} [columns] - Optional column names\r\n   */\r\n  table(data, columns) {\r\n    if (this.shouldLog('info')) {\r\n      const prefix = this.prefix ? `[${this.prefix}]` : '';\r\n      if (prefix) console.log(prefix);\r\n      console.table(data, columns);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Creates a new group in the console\r\n   * @param {string} label - The group label\r\n   */\r\n  group(label) {\r\n    if (this.shouldLog('info')) {\r\n      console.group(...this.formatMessage(label));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Creates a new collapsed group in the console\r\n   * @param {string} label - The group label\r\n   */\r\n  groupCollapsed(label) {\r\n    if (this.shouldLog('info')) {\r\n      console.groupCollapsed(...this.formatMessage(label));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ends the current console group\r\n   */\r\n  groupEnd() {\r\n    if (this.shouldLog('info')) {\r\n      console.groupEnd();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Starts a timer with the given label\r\n   * @param {string} label - The timer label\r\n   */\r\n  time(label) {\r\n    if (this.shouldLog('debug')) {\r\n      console.time(this.prefix ? `[${this.prefix}] ${label}` : label);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ends a timer with the given label\r\n   * @param {string} label - The timer label\r\n   */\r\n  timeEnd(label) {\r\n    if (this.shouldLog('debug')) {\r\n      console.timeEnd(this.prefix ? `[${this.prefix}] ${label}` : label);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets the log level\r\n   * @param {string} level - The new log level\r\n   */\r\n  setLevel(level) {\r\n    this.level = level;\r\n    this.currentLevel = LOG_LEVELS[level.toUpperCase()] ?? LOG_LEVELS.INFO;\r\n  }\r\n\r\n  /**\r\n   * Enables logging\r\n   */\r\n  enable() {\r\n    this.enabled = true;\r\n  }\r\n\r\n  /**\r\n   * Disables logging\r\n   */\r\n  disable() {\r\n    this.enabled = false;\r\n  }\r\n\r\n  /**\r\n   * Checks if logging is enabled\r\n   * @returns {boolean} True if logging is enabled\r\n   */\r\n  isEnabled() {\r\n    return this.enabled;\r\n  }\r\n}\r\n","import { Logger } from '../core/logger.js';\r\nimport { EVENTS } from '../core/constants.js';\r\n\r\n/**\r\n * Base class for editor adapters providing a common interface\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\nexport class EditorAdapter {\r\n  /**\r\n   * Creates a new EditorAdapter instance\r\n   * @param {HTMLElement} container - DOM element to contain the editor\r\n   * @param {Object} [options={}] - Editor configuration options\r\n   * @param {Object} [eventEmitter] - Event emitter for listening to global events\r\n   */\r\n  constructor(container, options = {}, eventEmitter = null) {\r\n    this.container = container;\r\n    this.options = options;\r\n    this.eventEmitter = eventEmitter;\r\n    this.changeHandlers = [];\r\n    this.executeHandlers = [];\r\n\r\n    this.logger = new Logger({\r\n      enabled: true,\r\n      level: 'info',\r\n      prefix: 'EditorAdapter'\r\n    });\r\n\r\n    // Listen for theme events if event emitter is provided\r\n    if (this.eventEmitter) {\r\n      this.logger.info('Setting up theme event listeners');\r\n\r\n      // Listen for theme ready (initial theme load)\r\n      this.eventEmitter.on(EVENTS.THEME_READY, (data) => {\r\n        this.logger.info('Base adapter received theme ready event:', data);\r\n        this.onThemeChange(data.theme, null);\r\n      });\r\n\r\n      // Listen for theme changes (user switching themes)\r\n      this.eventEmitter.on(EVENTS.THEME_CHANGE, (data) => {\r\n        this.logger.info('Base adapter received theme change event:', data);\r\n        this.onThemeChange(data.theme, data.oldTheme);\r\n      });\r\n    } else {\r\n      this.logger.warn('No event emitter provided - theme switching will not work');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the current code value from the editor\r\n   * @returns {string} The current code\r\n   * @throws {Error} Must be implemented by subclass\r\n   */\r\n  getValue() {\r\n    throw new Error('getValue() must be implemented by editor adapter');\r\n  }\r\n\r\n  /**\r\n   * Sets the code value in the editor\r\n   * @param {string} code - The code to set\r\n   * @throws {Error} Must be implemented by subclass\r\n   */\r\n  setValue(code) {\r\n    throw new Error('setValue() must be implemented by editor adapter');\r\n  }\r\n\r\n  /**\r\n   * Registers a callback for code change events\r\n   * @param {Function} callback - Callback function to call when code changes\r\n   */\r\n  onChange(callback) {\r\n    this.changeHandlers.push(callback);\r\n  }\r\n\r\n  /**\r\n   * Registers a callback for code execution events (Ctrl+Enter)\r\n   * @param {Function} callback - Callback function to call when user executes code\r\n   */\r\n  onExecute(callback) {\r\n    this.executeHandlers.push(callback);\r\n  }\r\n\r\n  /**\r\n   * Focuses the editor\r\n   * @throws {Error} Must be implemented by subclass\r\n   */\r\n  focus() {\r\n    throw new Error('focus() must be implemented by editor adapter');\r\n  }\r\n\r\n  /**\r\n   * Triggers all registered change handlers\r\n   */\r\n  triggerChange() {\r\n    this.changeHandlers.forEach(handler => handler(this.getValue()));\r\n  }\r\n\r\n  /**\r\n   * Triggers all registered execute handlers\r\n   */\r\n  triggerExecute() {\r\n    this.executeHandlers.forEach(handler => handler());\r\n  }\r\n\r\n  /**\r\n   * Called when theme changes - override in subclasses\r\n   * @param {string} newTheme - The new theme name\r\n   * @param {string} oldTheme - The previous theme name\r\n   */\r\n  onThemeChange(newTheme, oldTheme) {\r\n    // Override in subclasses to implement theme switching\r\n  }\r\n\r\n  /**\r\n   * Cleans up the editor instance\r\n   * Override if cleanup is needed\r\n   */\r\n  destroy() {\r\n    // Override if cleanup needed\r\n  }\r\n}","import { EditorAdapter } from './base.js';\r\nimport { Logger } from '../core/logger.js';\r\n\r\n/**\r\n * CodeMirror editor adapter with syntax highlighting and advanced features\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\nexport class CodeMirrorEditor extends EditorAdapter {\r\n  /**\r\n   * Creates a new CodeMirrorEditor instance\r\n   * @param {HTMLElement} container - DOM element to contain the editor\r\n   * @param {Object} [options={}] - Editor configuration options\r\n   * @param {string} [options.mode='javascript'] - CodeMirror language mode\r\n   * @param {string} [options.theme='darcula'] - CodeMirror theme\r\n   * @param {boolean} [options.autofocus=true] - Whether to autofocus the editor\r\n   * @param {Object} [eventEmitter] - Event emitter for listening to global events\r\n   */\r\n  constructor(container, options = {}, eventEmitter = null) {\r\n    super(container, options, eventEmitter);\r\n    this.cm = null;\r\n    this.currentTheme = options.theme || 'darcula';\r\n\r\n    this.logger = new Logger({\r\n      enabled: true,\r\n      level: 'info',\r\n      prefix: 'CodeMirrorEditor'\r\n    });\r\n\r\n    this.logger.info('CodeMirror editor initialized with theme:', this.currentTheme);\r\n    this.logger.info('Event emitter provided:', !!eventEmitter);\r\n\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Initializes the CodeMirror editor instance\r\n   * @throws {Error} If CodeMirror is not loaded\r\n   */\r\n  init() {\r\n    if (typeof CodeMirror === 'undefined') {\r\n      throw new Error('CodeMirror is not loaded. Include CodeMirror before using this adapter.');\r\n    }\r\n\r\n    const textarea = document.createElement('textarea');\r\n    this.container.appendChild(textarea);\r\n\r\n    this.cm = CodeMirror.fromTextArea(textarea, {\r\n      mode: this.options.mode || 'javascript',\r\n      theme: this.currentTheme,\r\n      lineNumbers: true,\r\n      lineWrapping: true,\r\n      indentUnit: 2,\r\n      tabSize: 2,\r\n      indentWithTabs: false,\r\n      autofocus: this.options.autofocus !== false,\r\n      extraKeys: {\r\n        'Ctrl-Enter': () => this.triggerExecute(),\r\n        'Cmd-Enter': () => this.triggerExecute()\r\n      }\r\n    });\r\n\r\n    this.cm.on('change', () => {\r\n      this.triggerChange();\r\n    });\r\n\r\n    // Apply glass effect on initial load\r\n    this.applyGlassEffect(this.currentTheme);\r\n  }\r\n\r\n  /**\r\n   * Gets the current code value from CodeMirror\r\n   * @returns {string} The current code\r\n   */\r\n  getValue() {\r\n    return this.cm.getValue();\r\n  }\r\n\r\n  /**\r\n   * Sets the code value in CodeMirror\r\n   * @param {string} code - The code to set\r\n   */\r\n  setValue(code) {\r\n    this.cm.setValue(code);\r\n  }\r\n\r\n  /**\r\n   * Focuses the CodeMirror editor\r\n   */\r\n  focus() {\r\n    this.cm.focus();\r\n  }\r\n\r\n  /**\r\n   * Handles theme change events\r\n   * @param {string} newTheme - The new theme name\r\n   * @param {string} oldTheme - The previous theme name\r\n   */\r\n  onThemeChange(newTheme, oldTheme) {\r\n    this.logger.info('onThemeChange called with:', { newTheme, oldTheme });\r\n    this.logger.info('Current theme before change:', this.currentTheme);\r\n    this.logger.info('CodeMirror instance exists:', !!this.cm);\r\n\r\n    if (this.cm && newTheme !== this.currentTheme) {\r\n      this.logger.info('Applying theme change from', this.currentTheme, 'to', newTheme);\r\n      this.currentTheme = newTheme;\r\n      this.cm.setOption('theme', newTheme);\r\n      this.logger.info('Theme applied successfully. CodeMirror theme is now:', this.cm.getOption('theme'));\r\n\r\n      // Apply glass glow effect by reducing background opacity\r\n      this.applyGlassEffect(newTheme);\r\n    } else {\r\n      this.logger.warn('Theme change skipped. Reasons:');\r\n      this.logger.warn('- CodeMirror exists:', !!this.cm);\r\n      this.logger.warn('- New theme different from current:', newTheme !== this.currentTheme);\r\n      this.logger.warn('- New theme value:', newTheme);\r\n      this.logger.warn('- Current theme value:', this.currentTheme);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Applies glass effect by reducing CodeMirror background opacity\r\n   * @param {string} theme - The current theme name\r\n   */\r\n  applyGlassEffect(theme) {\r\n    // Wait for theme to be applied, then modify background opacity\r\n    setTimeout(() => {\r\n      const cmElement = this.container.querySelector('.CodeMirror');\r\n      if (cmElement) {\r\n        this.logger.info('Applying glass effect for theme:', theme);\r\n\r\n        // Get the computed background color from the theme\r\n        const computedStyle = window.getComputedStyle(cmElement);\r\n        const backgroundColor = computedStyle.backgroundColor;\r\n        this.logger.info('Original background color:', backgroundColor);\r\n\r\n        // Parse the color and reduce opacity to 70% (not 50% - too transparent)\r\n        const reducedOpacityColor = this.reduceColorOpacity(backgroundColor, 0.7);\r\n        this.logger.info('Reduced opacity color:', reducedOpacityColor);\r\n\r\n        // Create or update style element for glass effect\r\n        let styleElement = document.getElementById('codemirror-glass-effect');\r\n        if (!styleElement) {\r\n          styleElement = document.createElement('style');\r\n          styleElement.id = 'codemirror-glass-effect';\r\n          document.head.appendChild(styleElement);\r\n        }\r\n\r\n        // Apply reduced opacity background to let glow show through\r\n        const themeClass = `.cm-s-${theme}`;\r\n        styleElement.textContent = `\r\n          ${themeClass}.CodeMirror {\r\n            background-color: ${reducedOpacityColor} !important;\r\n          }\r\n          ${themeClass} .CodeMirror-gutters {\r\n            background-color: ${this.reduceColorOpacity(backgroundColor, 0.8)} !important;\r\n          }\r\n        `;\r\n\r\n        this.logger.info('Glass effect applied with reduced opacity background');\r\n      }\r\n    }, 200); // Slightly longer delay to ensure theme CSS is fully loaded\r\n  }\r\n\r\n  /**\r\n   * Reduces the opacity of a CSS color value\r\n   * @param {string} color - The CSS color value (rgb, rgba, hex, etc.)\r\n   * @param {number} opacity - The target opacity (0-1)\r\n   * @returns {string} The color with reduced opacity in rgba format\r\n   */\r\n  reduceColorOpacity(color, opacity) {\r\n    // Handle rgba format\r\n    const rgbaMatch = color.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/);\r\n    if (rgbaMatch) {\r\n      const [, r, g, b] = rgbaMatch;\r\n      return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n    }\r\n\r\n    // Handle rgb format\r\n    const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\r\n    if (rgbMatch) {\r\n      const [, r, g, b] = rgbMatch;\r\n      return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n    }\r\n\r\n    // Handle hex format\r\n    const hexMatch = color.match(/^#([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i);\r\n    if (hexMatch) {\r\n      const r = parseInt(hexMatch[1], 16);\r\n      const g = parseInt(hexMatch[2], 16);\r\n      const b = parseInt(hexMatch[3], 16);\r\n      return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n    }\r\n\r\n    // Fallback for other formats or if parsing fails\r\n    this.logger.warn('Could not parse color:', color, 'using fallback');\r\n    return `rgba(0, 0, 0, ${opacity})`;\r\n  }\r\n\r\n  /**\r\n   * Gets the current theme\r\n   * @returns {string} Current theme name\r\n   */\r\n  getCurrentTheme() {\r\n    return this.currentTheme;\r\n  }\r\n\r\n  /**\r\n   * Sets the theme programmatically\r\n   * @param {string} theme - Theme name to set\r\n   */\r\n  setTheme(theme) {\r\n    if (this.cm && theme !== this.currentTheme) {\r\n      this.currentTheme = theme;\r\n      this.cm.setOption('theme', theme);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cleans up the CodeMirror editor by converting back to textarea\r\n   */\r\n  destroy() {\r\n    if (this.cm) {\r\n      this.cm.toTextArea();\r\n    }\r\n  }\r\n}"],"names":["DEFAULT_TIMEOUT_MS","NETWORK_TIMEOUT_MS","TEMPLATE_LOAD_TIMEOUT_MS","MIN_LEFT_PANE_WIDTH","MIN_RIGHT_PANE_WIDTH","MIN_CONSOLE_HEIGHT","MIN_PREVIEW_HEIGHT","RESIZE_HANDLE_WIDTH","DEFAULT_STORAGE_KEY","LOG_LEVELS","ERROR","WARN","INFO","DEBUG","TRACE","MOBILE_BREAKPOINT","DEFAULT_EXAMPLES_PATH","baseTag","document","querySelector","href","URL","pathname","window","location","includes","getBasePath","DEFAULT_TEMPLATE_PATH","EVENTS","INIT_START","INIT_COMPLETE","INIT_ERROR","CODE_CHANGE","CODE_LOAD","CODE_VALIDATE","CODE_EXECUTE_START","CODE_EXECUTE_COMPLETE","CODE_EXECUTE_TIMEOUT","CONSOLE_MESSAGE","CONSOLE_CLEAR","SANDBOX_RESET","STATUS_CHANGE","THEME_LOAD_START","THEME_LOAD_COMPLETE","THEME_CHANGE","THEME_READY","EDITOR_READY","EXAMPLE_LOAD","EXAMPLE_LOADED","EXAMPLE_ERROR","PANES_RESIZED","PANES_RESIZED_VERTICAL","DESTROY","STATUS_MESSAGES","executing","completed","timeout","reset","cleared","CRYPTO_ARRAY_SIZE","TEMPLATE_MARKERS","SECRET","USER_CODE","loggingManager","constructor","this","allowedComponents","Set","globalEnabled","allowAll","loadFromStorage","enable","components","forEach","add","comp","toLowerCase","saveToStorage","console","log","join","disable","delete","enableAll","disableAll","clear","status","Array","from","listComponents","registeredComponents","sort","enabled","isComponentEnabled","component","has","registerComponent","state","localStorage","setItem","JSON","stringify","e","parse","getItem","logFilter","list","Logger","options","level","prefix","redactSecrets","currentLevel","toUpperCase","shouldLog","componentAllowed","redactArgs","args","map","arg","replace","formatMessage","message","error","warn","info","debug","trace","wasRedacting","table","data","columns","group","label","groupCollapsed","groupEnd","time","timeEnd","setLevel","isEnabled","EditorAdapter","container","eventEmitter","changeHandlers","executeHandlers","logger","on","onThemeChange","theme","oldTheme","getValue","Error","setValue","code","onChange","callback","push","onExecute","focus","triggerChange","handler","triggerExecute","newTheme","destroy","CodeMirrorEditor","super","cm","currentTheme","init","CodeMirror","textarea","createElement","appendChild","fromTextArea","mode","lineNumbers","lineWrapping","indentUnit","tabSize","indentWithTabs","autofocus","extraKeys","applyGlassEffect","setOption","getOption","setTimeout","cmElement","backgroundColor","getComputedStyle","reducedOpacityColor","reduceColorOpacity","styleElement","getElementById","id","head","themeClass","textContent","color","opacity","rgbaMatch","match","r","g","b","rgbMatch","hexMatch","parseInt","getCurrentTheme","setTheme","toTextArea"],"mappings":"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"}