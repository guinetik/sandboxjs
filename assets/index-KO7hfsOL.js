import{f as e,E as t,C as i,S as o,i as n}from"./core-Db2HR9Ww.js";import{c as s,L as r,d as a,N as l,E as h,R as d,M as c,e as m,f as u,g,b as p,h as v,S as w,i as f,j as E}from"./vendor-Cr2mbvm1.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class x{constructor(e=s,t={}){this.key=e,this.logger=new r({enabled:t.debug||!1,level:"warn",prefix:"Storage"})}save(e){try{return localStorage.setItem(this.key,e),!0}catch(t){return this.logger.warn("Failed to save code to localStorage:",t),!1}}load(){try{return localStorage.getItem(this.key)}catch(e){return this.logger.warn("Failed to load code from localStorage:",e),null}}clear(){try{return localStorage.removeItem(this.key),!0}catch(e){return this.logger.warn("Failed to clear localStorage:",e),!1}}}class y{constructor(e={}){this.examplesPath=e.examplesPath||a,this.onLoad=e.onLoad||(()=>{}),this.onError=e.onError||(()=>{}),this.examples=new Map,this.logger=new r({enabled:e.debug||!1,level:"info",prefix:"ExamplesLoader"})}async discoverExamples(){const t=[{id:"hello-world",title:"üëã Hello World",description:"Simple greeting with interactive button",file:"hello-world.js"},{id:"spinning-animation",title:"üåÄ CSS Animations",description:"Spinning box with rainbow colors and controls",file:"spinning-animation.js"},{id:"interactive-form",title:"üìù Interactive Form",description:"Form validation and submission handling",file:"interactive-form.js"},{id:"canvas-drawing",title:"üé® Canvas Drawing",description:"Draw with mouse or touch on HTML5 canvas",file:"canvas-drawing.js"}],i=[];this.logger.info(`Discovering examples from: ${this.examplesPath}`);for(const n of t)try{const t=`${this.examplesPath}/${n.file}`;this.logger.debug(`Fetching example: ${t}`);const o=await e(t,{},l);if(o.ok){const e=await o.text();this.examples.set(n.id,{...n,code:e}),i.push(n),this.logger.debug(`‚úì Example loaded: ${n.id}`)}else this.logger.warn(`‚úó Example ${n.id} returned ${o.status}`)}catch(o){this.logger.warn(`‚úó Example ${n.id} failed:`,o.message)}return this.logger.info(`Discovered ${i.length} of ${t.length} examples`),i}async loadExample(e){if(this.examples.has(e)){const t=this.examples.get(e);return this.onLoad(t),t}try{await this.discoverExamples();const t=this.examples.get(e);if(t)return this.onLoad(t),t;throw new Error(`Example '${e}' not found`)}catch(t){throw this.logger.error("Failed to load example:",t),this.onError(t),t}}getAvailableExamples(){return Array.from(this.examples.values())}clearCache(){this.logger.debug("Clearing examples cache"),this.examples.clear()}destroy(){this.logger.debug("Destroying examples loader"),this.clearCache()}}class b{constructor(e,t={}){this.container=e,this.onSelect=t.onSelect||(()=>{}),this.examples=[],this.createDropdown()}createDropdown(){const e=this.container.querySelector(".examples-dropdown");e&&e.remove(),this.dropdown=document.createElement("select"),this.dropdown.className="examples-dropdown",this.dropdown.innerHTML='<option value="">üìö Load Example...</option>',this.dropdown.addEventListener("change",e=>{const t=e.target.value;t&&(this.onSelect(t),setTimeout(()=>{this.dropdown.value=""},100))});const t=this.container.querySelector("label.btn");t?this.container.insertBefore(this.dropdown,t.nextSibling):this.container.appendChild(this.dropdown)}setExamples(e){this.examples=e,this.dropdown.innerHTML='<option value="">üìö Load Example...</option>',e.forEach(e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.title,t.title=e.description,this.dropdown.appendChild(t)}),this.dropdown.disabled=0===e.length}setLoading(e=!0){e?(this.dropdown.innerHTML='<option value="">‚è≥ Loading examples...</option>',this.dropdown.disabled=!0):(this.dropdown.innerHTML='<option value="">üìö Load Example...</option>',this.dropdown.disabled=!1)}setError(e="Failed to load examples"){this.dropdown.innerHTML=`<option value="">‚ùå ${e}</option>`,this.dropdown.disabled=!0}destroy(){this.dropdown&&this.dropdown.parentNode&&this.dropdown.parentNode.removeChild(this.dropdown)}}class S{constructor(e,t,i={}){this.container=e,this.eventEmitter=t,this.options={defaultTheme:"darcula",debug:!0,storageKey:"sandbox_current_theme",...i},this.logger=new r({enabled:this.options.debug,level:"info",prefix:"ThemeSwitcher"}),this.themes=[{value:"default",label:"üè≥Ô∏è Default"},{value:"darcula",label:"üåô Darcula"},{value:"monokai",label:"üéØ Monokai"},{value:"solarized",label:"‚òÄÔ∏è Solarized Dark"},{value:"material",label:"üì± Material"},{value:"dracula",label:"üßõ Dracula"},{value:"tomorrow-night-eighties",label:"üåâ Tomorrow Night"},{value:"base16-dark",label:"üåÉ Base16 Dark"},{value:"blackboard",label:"‚ö´ Blackboard"},{value:"eclipse",label:"üåÖ Eclipse"}],this.currentTheme=this.loadSavedTheme()||this.options.defaultTheme,this.logger.info("Initializing theme switcher with theme:",this.currentTheme),this.createDropdown(),this.initializeCurrentTheme()}async initializeCurrentTheme(){this.logger.info("Initializing current theme:",this.currentTheme),this.eventEmitter.emit(h.THEME_LOAD_START,{theme:this.currentTheme});try{await this.loadThemeCSS(this.currentTheme),this.logger.info("Current theme CSS loaded:",this.currentTheme),this.eventEmitter.emit(h.THEME_READY,{theme:this.currentTheme})}catch(e){this.logger.warn("Failed to load current theme CSS:",e),this.eventEmitter.emit(h.THEME_READY,{theme:"darcula",error:e.message})}}createDropdown(){const e=this.container.querySelector(".theme-switcher");e&&e.remove(),this.dropdown=document.createElement("select"),this.dropdown.className="theme-switcher examples-dropdown",this.dropdown.title="Switch editor theme",this.populateThemes(),this.dropdown.value=this.currentTheme,this.dropdown.addEventListener("change",async e=>{const t=e.target.value;this.logger.info("Theme dropdown changed to:",t),this.logger.info("Current theme is:",this.currentTheme),t&&t!==this.currentTheme?(this.logger.info("Switching theme from",this.currentTheme,"to",t),await this.switchTheme(t)):this.logger.warn("Theme value is empty or same as current theme")});const t=this.container.querySelector(".examples-dropdown"),i=this.container.querySelector("label.btn");t?this.container.insertBefore(this.dropdown,t.nextSibling):i?this.container.insertBefore(this.dropdown,i.nextSibling):this.container.appendChild(this.dropdown)}populateThemes(){this.dropdown.innerHTML="",this.themes.forEach(e=>{const t=document.createElement("option");t.value=e.value,t.textContent=e.label,this.dropdown.appendChild(t)})}async loadThemeCSS(e){if("default"===e)return void this.logger.info("Skipping CSS load for default theme");if(document.querySelector(`link[href*="theme/${e}"]`))return void this.logger.info("Theme CSS already loaded for:",e);this.logger.info("Loading theme CSS for:",e);const t=document.createElement("link");return t.rel="stylesheet",t.href=`https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/${e}.min.css`,new Promise((i,o)=>{t.onload=()=>{this.logger.info("Theme CSS loaded successfully for:",e),i()},t.onerror=()=>{this.logger.error("Failed to load theme CSS for:",e),o(new Error(`Failed to load theme: ${e}`))},document.head.appendChild(t)})}loadSavedTheme(){try{const e=localStorage.getItem(this.options.storageKey);if(e&&this.themes.find(t=>t.value===e))return this.logger.info("Loaded saved theme from storage:",e),e}catch(e){this.logger.warn("Failed to load saved theme:",e)}return null}saveTheme(e){try{localStorage.setItem(this.options.storageKey,e),this.logger.info("Saved theme to storage:",e)}catch(t){this.logger.warn("Failed to save theme:",t)}}async switchTheme(e){const t=this.currentTheme;this.currentTheme=e,this.logger.info("switchTheme called: changing from",t,"to",e),this.dropdown.value=e,this.logger.info("Dropdown value updated to:",this.dropdown.value);try{await this.loadThemeCSS(e),this.saveTheme(e),this.logger.info("Emitting theme change event with data:",{theme:e,oldTheme:t}),this.eventEmitter.emit(h.THEME_CHANGE,{theme:e,oldTheme:t}),this.logger.info("Theme change event emitted successfully")}catch(i){this.logger.error("Failed to switch theme:",i),this.dropdown.value=t,this.currentTheme=t}}getCurrentTheme(){return this.currentTheme}setTheme(e){this.themes.find(t=>t.value===e)&&this.switchTheme(e)}addTheme(e,t){this.themes.find(t=>t.value===e)||(this.themes.push({value:e,label:t}),this.populateThemes(),this.dropdown.value=this.currentTheme)}destroy(){this.dropdown&&this.dropdown.parentNode&&this.dropdown.parentNode.removeChild(this.dropdown)}}class C{constructor(e={}){this.options={transitionDuration:8e3,autoRotate:!0,debug:!1,...e},this.logger=new r({enabled:this.options.debug,level:"info",prefix:"NeonGlow"}),this.hue1=this.randomHue(),this.hue2=this.randomHue(),this.rotationInterval=null,this.glowElements=new Set}randomHue(){return Math.floor(360*Math.random())}complementaryHue(e){return(e+(80+Math.floor(60*Math.random())-30))%360}applyGlow(e,t={}){e.classList.add("neon-glow");const i=document.createElement("div");i.className="neon-glow-container";const o=document.createElement("div");o.className="neon-shine",i.appendChild(o),e.appendChild(i),this.glowElements.add(e),this.logger.debug("Applied glow to element:",e)}updateHues(e,t){this.hue1=e,this.hue2=t,document.documentElement.style.setProperty("--hue1",String(e)),document.documentElement.style.setProperty("--hue2",String(t)),this.logger.debug(`Updated hues: ${e}, ${t}`)}rotateColors(){const e=this.randomHue(),t=this.complementaryHue(e);this.logger.info(`Rotating colors: ${e}, ${t}`),this.updateHues(e,t)}startRotation(){this.rotationInterval&&this.stopRotation(),this.rotateColors(),this.rotationInterval=setInterval(()=>{this.rotateColors()},this.options.transitionDuration),this.logger.info("Started color rotation")}stopRotation(){this.rotationInterval&&(clearInterval(this.rotationInterval),this.rotationInterval=null,this.logger.info("Stopped color rotation"))}removeGlow(e){e.classList.remove("neon-glow");const t=e.querySelector(".neon-glow-container");t&&t.remove(),this.glowElements.delete(e)}destroy(){this.logger.info("Destroying neon glow manager"),this.stopRotation(),this.glowElements.forEach(e=>{this.removeGlow(e)}),this.glowElements.clear()}}class L{constructor(e={}){this.options={timeLimit:p,storageKey:s,defaultCode:this.getDefaultCode(),debug:!1,logLevel:"info",...e},this.logger=new r({enabled:this.options.debug,level:this.options.logLevel,prefix:"Controller"}),this.events=new t,this.editor=null,this.sandbox=null,this.console=null,this.storage=null,this.examples=null,this.examplesDropdown=null,this.themeSwitcher=null,this.neonGlow=null,this.elements={},this.resizeHandlers=[],this.responsiveListener=null,this.isInitialized=!1}getDefaultCode(){return["// Welcome to JS Sandbox! üôå","//","// Tips:","//  - Use console.log/info/warn/error","//  - Ctrl/Cmd+Enter to execute",'//  - "Reset" kills stuck executions',"//","// Examples:",'console.log("Hello, sandbox!");',"function noReturn() { var x = 1+1; }","noReturn(); // no return value, all good","","// DOM inside sandbox:",'var el = document.createElement("h1");','el.textContent = "Hello from iframe!";',"document.body.appendChild(el);","","// Errors:",'Promise.reject("rejected!");','// throw new Error("Exception thrown");',"","// Infinite loop test (commented):","// while(true) {}"].join("\n")}async init(){if(this.isInitialized)this.logger.warn("Controller already initialized");else try{this.events.emit(h.INIT_START),this.logger.info("Initializing controller..."),this.findElements(),await this.initializeComponents(),this.setupEventListeners(),this.isInitialized=!0,this.events.emit(h.INIT_COMPLETE),this.logger.info("Controller initialization complete")}catch(e){throw this.logger.error("Initialization failed:",e),this.events.emit(h.INIT_ERROR,e),this.showInitializationError(e),e}}showInitializationError(e){if(this.elements.consoleContainer){const t=document.createElement("div");t.className="console-line console-error",t.textContent=`‚ö†Ô∏è Initialization failed: ${e.message}`,this.elements.consoleContainer.appendChild(t)}}findElements(){this.elements={app:document.querySelector(".app"),editorContainer:document.getElementById("editorContainer"),consoleContainer:document.getElementById("console"),sandboxContainer:document.getElementById("sandboxContainer"),runBtn:document.getElementById("runBtn"),clearBtn:document.getElementById("clearBtn"),resetBtn:document.getElementById("resetBtn"),togglePreview:document.getElementById("togglePreview"),previewWrap:document.getElementById("previewWrap"),status:document.getElementById("status"),limitLabel:document.getElementById("limitLabel"),toolbar:document.querySelector(".toolbar")};const e=["app","editorContainer","consoleContainer","sandboxContainer"].filter(e=>!this.elements[e]);if(e.length>0)throw new Error(`Missing required elements: ${e.join(", ")}`)}async initializeComponents(){this.logger.info("Initializing components...");try{this.storage=new x(this.options.storageKey,{debug:this.options.debug}),this.logger.debug("Storage initialized")}catch(t){this.logger.error("Storage initialization failed:",t)}try{this.console=new i(this.elements.consoleContainer,{debug:this.options.debug}),this.logger.debug("Console initialized")}catch(t){throw this.logger.error("Console initialization failed:",t),new Error("Failed to initialize console output")}try{this.sandbox=new o(this.elements.sandboxContainer,{timeLimit:this.options.timeLimit,debug:this.options.debug,logLevel:this.options.logLevel,onMessage:(e,t)=>{this.console.addLine(e,t),this.events.emit(h.CONSOLE_MESSAGE,{type:e,args:t})},onStatusChange:e=>this.updateStatus(e)}),this.logger.debug("SandboxEngine created"),await this.sandbox.initialize(),this.logger.info("Sandbox initialized")}catch(t){throw this.logger.error("Sandbox initialization failed:",t),new Error(`Failed to initialize sandbox: ${t.message}`)}try{if(this.examples=new y({onLoad:e=>this.events.emit(h.EXAMPLE_LOAD,e),onError:e=>this.events.emit(h.EXAMPLE_ERROR,e),debug:!0}),this.elements.toolbar&&!this.examplesDropdown){this.examplesDropdown=new b(this.elements.toolbar,{onSelect:e=>this.loadExample(e)});try{this.examplesDropdown.setLoading(!0);const e=await this.examples.discoverExamples();this.examplesDropdown.setExamples(e),this.logger.info("Examples loaded:",e.length)}catch(t){this.logger.error("Failed to load examples:",t),this.examplesDropdown.setError("Failed to load")}}this.elements.toolbar&&!this.themeSwitcher&&(this.themeSwitcher=new S(this.elements.toolbar,this.events,{defaultTheme:"darcula"}),this.logger.info("Theme switcher initialized"))}catch(t){this.logger.warn("Examples system initialization failed:",t)}this.elements.limitLabel&&(this.elements.limitLabel.textContent=this.options.timeLimit+"ms"),this.initializeResizer(),this.setupResponsiveListener();const e=this.elements.app.querySelector(".pane.right");if(e&&this.elements.previewWrap){const t=this.elements.previewWrap.classList.contains("show");e.classList.toggle("has-preview",t)}this.initializeNeonGlow(),this.logger.info("Components initialization complete")}initializeNeonGlow(){try{this.neonGlow=new C({transitionDuration:8e3,autoRotate:!0,debug:!0});this.elements.app.querySelectorAll(".pane").forEach(e=>{this.neonGlow.applyGlow(e)}),this.neonGlow.startRotation(),this.logger.info("Neon glow effects initialized")}catch(e){this.logger.warn("Failed to initialize neon glow:",e)}}cleanupResizeHandlers(){this.resizeHandlers.forEach(e=>{e&&e.cleanup&&e.cleanup()}),this.resizeHandlers=[]}initializeResizer(){if(!this.elements.app)return;if(this.cleanupResizeHandlers(),n(v))return void this.initializeVerticalResize();const e=this.elements.app.querySelector(".main-content");if(!e)return;this.elements.app.querySelectorAll(".resize-handle, .vertical-resize-handle").forEach(e=>e.remove()),e.style.gridTemplateColumns="",e.style.gridTemplateRows="";const t=e.querySelector(".pane:last-child");t&&(t.style.gridTemplateRows="",t.classList.remove("preview-hidden"));const i=document.createElement("div");i.className="resize-handle";const o=e.querySelectorAll(".pane");if(o.length>=2){e.insertBefore(i,o[1]);const t=function(e){const{container:t,leftPane:i,rightPane:o,handle:n,onResize:s}=e;let r=!1,a=0,l=0;const h=e=>{r=!0,a=e.clientX,n.classList.add("dragging"),l=i.getBoundingClientRect().width,o.getBoundingClientRect().width,document.body.style.userSelect="none",document.body.style.cursor="col-resize",e.preventDefault()},u=e=>{if(!r)return;const i=e.clientX-a,o=t.getBoundingClientRect().width-d-10,n=Math.max(c,Math.min(o-m,l+i)),s=o-n;t.style.gridTemplateColumns=`${n}px ${d}px ${s}px`,e.preventDefault()},g=()=>{r&&(r=!1,n.classList.remove("dragging"),document.body.style.userSelect="",document.body.style.cursor="",s&&s())};return n.addEventListener("mousedown",h),document.addEventListener("mousemove",u),document.addEventListener("mouseup",g),{handleMouseDown:h,handleMouseMove:u,handleMouseUp:g,cleanup:()=>{n.removeEventListener("mousedown",h),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",g)}}}({container:e,leftPane:o[0],rightPane:o[1],handle:i,onResize:()=>this.events.emit(h.PANES_RESIZED)});this.resizeHandlers.push(t)}this.initializeVerticalResize()}setupResponsiveListener(){this.responsiveListener&&this.responsiveListener.mediaQuery.removeListener(this.responsiveListener.handleChange);const e=window.matchMedia(`(max-width: ${v}px)`),t=()=>{this.logger.debug("Responsive breakpoint changed"),this.initializeResizer()};e.addListener(t),this.responsiveListener={mediaQuery:e,handleChange:t}}initializeVerticalResize(){const e=this.elements.app.querySelector(".pane.right");if(!e)return;const t=document.createElement("div");t.className="vertical-resize-handle";const i=e.querySelector(".console");if(i){i.parentNode.insertBefore(t,i.nextSibling);const o=function(e){const{container:t,topPane:i,bottomPane:o,handle:n,onResize:s,shouldResize:r}=e;let a=!1,l=0,h=0,d=0;const c=e=>{if(r&&!r())return;a=!0,l=e.clientY,n.classList.add("dragging");const t=i.getBoundingClientRect(),s=o.getBoundingClientRect();h=t.height,d=s.height,document.body.style.userSelect="none",document.body.style.cursor="row-resize",e.preventDefault()},m=e=>{if(!a)return;const i=e.clientY-l,o=h+d,n=Math.max(u,Math.min(o-g,h+i)),s=o-n;t.style.gridTemplateRows=`auto ${n}px 8px ${s}px auto`,e.preventDefault()},p=()=>{a&&(a=!1,n.classList.remove("dragging"),document.body.style.userSelect="",document.body.style.cursor="",s&&s())};return n.addEventListener("mousedown",c),document.addEventListener("mousemove",m),document.addEventListener("mouseup",p),{handleMouseDown:c,handleMouseMove:m,handleMouseUp:p,cleanup:()=>{n.removeEventListener("mousedown",c),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)}}}({container:e,topPane:i,bottomPane:this.elements.previewWrap,handle:t,shouldResize:()=>this.elements.previewWrap.classList.contains("show"),onResize:()=>this.events.emit(h.PANES_RESIZED_VERTICAL)});this.resizeHandlers.push(o)}}getEventEmitter(){return this.events}setEditor(e){this.editor&&this.editor.destroy(),this.editor=e,this.editor.onChange(e=>{this.storage&&this.storage.save(e),this.events.emit(h.CODE_CHANGE,{code:e})}),this.editor.onExecute(()=>{this.run()}),this.loadInitialCode(),this.events.emit(h.EDITOR_READY,{editor:e})}setupEventListeners(){this.elements.runBtn&&this.elements.runBtn.addEventListener("click",()=>this.run()),this.elements.clearBtn&&this.elements.clearBtn.addEventListener("click",()=>this.clearConsole()),this.elements.resetBtn&&this.elements.resetBtn.addEventListener("click",()=>this.reset()),this.elements.togglePreview&&this.elements.togglePreview.addEventListener("change",e=>{this.elements.previewWrap.classList.toggle("show",e.target.checked);const t=this.elements.app.querySelector(".pane.right");t&&(e.target.checked?t.classList.add("has-preview"):(t.classList.remove("has-preview"),t.style.gridTemplateRows=""))}),this.setupThemeEventListeners()}setupThemeEventListeners(){this.events.on(h.THEME_LOAD_START,e=>{this.logger.info("Theme loading started:",e.theme)}),this.events.on(h.THEME_READY,e=>{this.logger.info("Theme ready:",e.theme),e.error&&this.logger.warn("Theme ready with error:",e.error)}),this.events.on(h.THEME_CHANGE,e=>{this.logger.info("Theme changed from",e.oldTheme,"to",e.theme)})}loadInitialCode(){const e=this.storage?this.storage.load():null,t=e||this.options.defaultCode;this.editor&&(this.editor.setValue(t),this.editor.focus(),this.events.emit(h.CODE_LOAD,{code:t,fromStorage:!!e}))}run(){if(!this.editor)return void this.logger.error("No editor configured");const e=this.editor.getValue();this.events.emit(h.CODE_EXECUTE_START,{code:e});const t=this.sandbox.validateSyntax(e);this.events.emit(h.CODE_VALIDATE,{code:e,validation:t}),this.console.clear(),this.sandbox.execute(e)}clearConsole(){this.console.clear(),this.updateStatus(w.cleared),this.events.emit(h.CONSOLE_CLEAR)}reset(){this.sandbox.reset(),this.updateStatus(w.reset),this.events.emit(h.SANDBOX_RESET)}updateStatus(e){if(!this.elements.status)return;const t=w[e]||e;this.elements.status.textContent=t,this.events.emit(h.STATUS_CHANGE,{status:e,displayStatus:t}),"completed"===e?this.events.emit(h.CODE_EXECUTE_COMPLETE):"timeout"===e&&this.events.emit(h.CODE_EXECUTE_TIMEOUT)}on(e,t,i){return this.events.on(e,t,i)}once(e,t){return this.events.once(e,t)}off(e,t){this.events.off(e,t)}getCode(){return this.editor?this.editor.getValue():null}setCode(e){this.editor&&this.editor.setValue(e)}validateCode(e){const t=e||this.getCode();return this.sandbox?this.sandbox.validateSyntax(t):{valid:!1,error:"Sandbox not initialized"}}async loadExample(e){try{this.logger.info("Loading example:",e);const t=await this.examples.loadExample(e);if(this.setCode(t.code),this.elements.togglePreview&&!this.elements.togglePreview.checked){this.elements.togglePreview.checked=!0,this.elements.previewWrap.classList.add("show");const e=this.elements.app.querySelector(".pane.right");e&&e.classList.add("has-preview")}this.run(),this.events.emit(h.EXAMPLE_LOADED,{exampleId:e,example:t})}catch(t){this.logger.error("Failed to load example:",t),this.events.emit(h.EXAMPLE_ERROR,t)}}destroy(){this.logger.info("Destroying controller..."),this.events.emit(h.DESTROY),this.editor&&(this.editor.destroy(),this.editor=null),this.sandbox&&(this.sandbox.destroy(),this.sandbox=null),this.examples&&(this.examples.destroy(),this.examples=null),this.examplesDropdown&&(this.examplesDropdown.destroy(),this.examplesDropdown=null),this.neonGlow&&(this.neonGlow.destroy(),this.neonGlow=null),this.cleanupResizeHandlers(),this.responsiveListener&&(this.responsiveListener.mediaQuery.removeListener(this.responsiveListener.handleChange),this.responsiveListener=null),this.events.removeAllListeners(),this.isInitialized=!1,this.logger.info("Controller destroyed")}}class T extends f{constructor(e,t={},i=null){super(e,t,i),this.textarea=null,this.init()}init(){this.textarea=document.createElement("textarea"),this.textarea.className="code-editor",this.textarea.spellcheck=!1,this.textarea.placeholder=this.options.placeholder||"Enter your JavaScript code here...",this.container.appendChild(this.textarea),this.setupEventListeners()}setupEventListeners(){this.textarea.addEventListener("input",()=>{this.triggerChange()}),this.textarea.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&(e.preventDefault(),this.triggerExecute())})}getValue(){return this.textarea.value}setValue(e){this.textarea.value=e}focus(){this.textarea.focus()}destroy(){this.textarea&&this.textarea.remove()}}async function z(e={}){const t=e.debug||!1,i=new r({enabled:t,level:e.logLevel||"info",prefix:"App"});try{i.info("Starting sandbox initialization...");const o=new L(e);await o.init(),i.info("Controller initialized");const n=document.getElementById("editorContainer");if(!n)throw new Error("Editor container element not found");const s=function(e,t={},i=null){const o=new r({enabled:t.debug||!1,level:"info",prefix:"EditorFactory"});if("undefined"!=typeof CodeMirror)try{return o.info("Initializing CodeMirror editor"),new E(e,t,i)}catch(n){o.warn("Failed to initialize CodeMirror, falling back to textarea:",n)}return o.info("Initializing textarea editor"),new T(e,t,i)}(n,{mode:"javascript",theme:"darcula",autofocus:!0,debug:t},o.getEventEmitter());return i.info("Editor created, waiting for theme ready event"),o.setEditor(s),i.info("Editor set on controller"),i.info("Sandbox initialization complete"),o}catch(o){throw i.error("Sandbox initialization failed:",o),o}}function R(){!window.sandbox&&document.getElementById("editorContainer")&&z({debug:!1}).then(e=>{window.sandbox=e,console.log("‚úÖ Sandbox initialized successfully")}).catch(e=>{console.error("‚ùå Failed to initialize sandbox:",e)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",R):R();
//# sourceMappingURL=index-KO7hfsOL.js.map
