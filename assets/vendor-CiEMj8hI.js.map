{"version":3,"file":"vendor-CiEMj8hI.js","sources":["../../src/core/constants.js","../../src/core/logger.js","../../src/editors/base.js","../../src/editors/autocomplete/advanced.js","../../src/editors/input.js","../../src/editors/codemirror.js","../../src/editors/autocomplete/setup.js"],"sourcesContent":["/**\r\n * Application-wide constants\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\n\r\n// Execution timeouts\r\nexport const DEFAULT_TIMEOUT_MS = 4000;\r\nexport const NETWORK_TIMEOUT_MS = 5000;\r\nexport const TEMPLATE_LOAD_TIMEOUT_MS = 5000;\r\n\r\n// UI dimensions\r\nexport const MIN_LEFT_PANE_WIDTH = 320;\r\nexport const MIN_RIGHT_PANE_WIDTH = 420;\r\nexport const MIN_CONSOLE_HEIGHT = 100;\r\nexport const MIN_PREVIEW_HEIGHT = 100;\r\nexport const RESIZE_HANDLE_WIDTH = 5;\r\nexport const VERTICAL_RESIZE_HANDLE_HEIGHT = 8;\r\n\r\n// Storage keys\r\nexport const DEFAULT_STORAGE_KEY = 'js-sandbox-code';\r\n\r\n// Log levels\r\nexport const LOG_LEVELS = {\r\n  ERROR: 0,\r\n  WARN: 1,\r\n  INFO: 2,\r\n  DEBUG: 3,\r\n  TRACE: 4\r\n};\r\n\r\n// Default log level\r\nexport const DEFAULT_LOG_LEVEL = 'info';\r\n\r\n// Mobile breakpoint\r\nexport const MOBILE_BREAKPOINT = 768;\r\n\r\n/**\r\n * Gets the base path from the current document base or defaults to root\r\n * @returns {string} The base path (e.g., '/sandboxjs/' or '/')\r\n */\r\nfunction getBasePath() {\r\n  // Check if there's a base tag\r\n  const baseTag = document.querySelector('base');\r\n  if (baseTag && baseTag.href) {\r\n    const url = new URL(baseTag.href);\r\n    return url.pathname;\r\n  }\r\n  \r\n  // Fallback: detect from current path\r\n  const path = window.location.pathname;\r\n  // If path includes /sandboxjs/, use that as base\r\n  if (path.includes('/sandboxjs/')) {\r\n    return '/sandboxjs/';\r\n  }\r\n  \r\n  return '/';\r\n}\r\n\r\n// Examples path - dynamically determined based on base path\r\nexport const DEFAULT_EXAMPLES_PATH = getBasePath() + 'examples';\r\n\r\n// Environment-based template path resolution\r\nexport const DEFAULT_TEMPLATE_PATH = (() => {\r\n  // Check if we're in development mode (Vite sets this)\r\n  const isDevelopment = import.meta.env.DEV;\r\n\r\n  if (isDevelopment) {\r\n    // Development: load from src\r\n    return './src/ui/sandbox.html';\r\n  } else {\r\n    // Production: load from assets\r\n    return './assets/sandbox.html';\r\n  }\r\n})();\r\n\r\n// Event names\r\nexport const EVENTS = {\r\n  // Initialization\r\n  INIT_START: 'init:start',\r\n  INIT_COMPLETE: 'init:complete',\r\n  INIT_ERROR: 'init:error',\r\n  \r\n  // Code events\r\n  CODE_CHANGE: 'code:change',\r\n  CODE_LOAD: 'code:load',\r\n  CODE_VALIDATE: 'code:validate',\r\n  CODE_EXECUTE_START: 'code:execute:start',\r\n  CODE_EXECUTE_COMPLETE: 'code:execute:complete',\r\n  CODE_EXECUTE_TIMEOUT: 'code:execute:timeout',\r\n  \r\n  // Console events\r\n  CONSOLE_MESSAGE: 'console:message',\r\n  CONSOLE_CLEAR: 'console:clear',\r\n  \r\n  // Sandbox events\r\n  SANDBOX_RESET: 'sandbox:reset',\r\n  \r\n  // Status events\r\n  STATUS_CHANGE: 'status:change',\r\n\r\n  // Theme events\r\n  THEME_LOAD_START: 'theme:load:start',\r\n  THEME_LOAD_COMPLETE: 'theme:load:complete',\r\n  THEME_CHANGE: 'theme:change',\r\n  THEME_READY: 'theme:ready',\r\n  \r\n  // Editor events\r\n  EDITOR_READY: 'editor:ready',\r\n  EDITOR_CHANGE: 'editor:change',\r\n  EDITOR_CHANGED: 'editor:changed',\r\n  \r\n  // Example events\r\n  EXAMPLE_LOAD: 'example:load',\r\n  EXAMPLE_LOADED: 'example:loaded',\r\n  EXAMPLE_ERROR: 'example:error',\r\n  \r\n  // Pane events\r\n  PANES_RESIZED: 'panes:resized',\r\n  PANES_RESIZED_VERTICAL: 'panes:resized:vertical',\r\n\r\n  // Fullscreen events\r\n  FULLSCREEN_TOGGLE: 'fullscreen:toggle',\r\n  FULLSCREEN_EDITOR: 'fullscreen:editor',\r\n  FULLSCREEN_CONSOLE: 'fullscreen:console',\r\n  FULLSCREEN_EXIT: 'fullscreen:exit',\r\n\r\n  // Library events\r\n  LIBRARY_MANAGER_OPEN: 'library:manager:open',\r\n  LIBRARY_ADD: 'library:add',\r\n  LIBRARY_ADDED: 'library:added',\r\n  LIBRARY_REMOVE: 'library:remove',\r\n  LIBRARY_REMOVED: 'library:removed',\r\n  DOMAIN_TRUST_REQUEST: 'domain:trust:request',\r\n  DOMAIN_ADDED: 'domain:added',\r\n  DOMAIN_REMOVED: 'domain:removed',\r\n  LIBRARIES_CLEARED: 'libraries:cleared',\r\n\r\n  // Share events\r\n  SHARE_SUCCESS: 'share:success',\r\n  SHARE_ERROR: 'share:error',\r\n\r\n  // Destroy\r\n  DESTROY: 'destroy'\r\n};\r\n\r\n// Status messages\r\nexport const STATUS_MESSAGES = {\r\n  executing: 'Executing‚Ä¶',\r\n  completed: 'Completed',\r\n  timeout: 'Timeout exceeded',\r\n  reset: 'Sandbox reset',\r\n  cleared: 'Console cleared'\r\n};\r\n\r\n// Security\r\nexport const CRYPTO_ARRAY_SIZE = 2;\r\n\r\n// Template markers\r\nexport const TEMPLATE_MARKERS = {\r\n  SECRET: '{{SECRET}}',\r\n  USER_CODE: '{{USER_CODE}}',\r\n  DYNAMIC_CSP: '{{DYNAMIC_CSP}}',\r\n  LIBRARY_SCRIPTS: '{{LIBRARY_SCRIPTS}}'\r\n};\r\n\r\n// Editor themes\r\nexport const EDITOR_THEMES = {\r\n  ACE: [\r\n    { value: 'dracula', label: 'üßõ Dracula' },\r\n    { value: 'ambiance', label: 'üé® Ambiance' },\r\n    { value: 'chaos', label: 'üå™Ô∏è Chaos' },\r\n    { value: 'clouds_midnight', label: '‚òÅÔ∏è Clouds Midnight' },\r\n    { value: 'cobalt', label: 'üîµ Cobalt' },\r\n    { value: 'gruvbox', label: 'üé® Gruvbox' },\r\n    { value: 'gob', label: 'üü¢ Green on Black' },\r\n    { value: 'idle_fingers', label: 'üëÜ Idle Fingers' },\r\n    { value: 'kr_theme', label: 'üåÉ Karyonight' },\r\n    { value: 'merbivore', label: 'üçá Merbivore' },\r\n    { value: 'merbivore_soft', label: 'üçá Merbivore Soft' },\r\n    { value: 'mono_industrial', label: 'üè≠ Mono Industrial' },\r\n    { value: 'monokai', label: 'üéØ Monokai' },\r\n    { value: 'nord_dark', label: '‚ùÑÔ∏è Nord on Dark' },\r\n    { value: 'one_dark', label: 'üåë One Dark' },\r\n    { value: 'pastel_on_dark', label: 'üé® Pastel on Dark' },\r\n    { value: 'solarized_dark', label: '‚òÄÔ∏è Solarized Dark' },\r\n    { value: 'solarized_light', label: '‚òÄÔ∏è Solarized Light' },\r\n    { value: 'github_dark', label: 'üêô Github Dark' },\r\n    { value: 'cloud_editor_light', label: '‚òÅÔ∏è Cloud Editor Light' },\r\n    { value: 'terminal', label: 'üñ•Ô∏è Terminal' }\r\n  ],\r\n  CODEMIRROR: [\r\n    { value: 'material', label: 'üì± Material' },\r\n    { value: 'default', label: 'üè≥Ô∏è Default' },\r\n    { value: 'darcula', label: 'üåô Darcula' },\r\n    { value: 'monokai', label: 'üéØ Monokai' },\r\n    { value: 'solarized', label: '‚òÄÔ∏è Solarized Dark' },\r\n    { value: 'dracula', label: 'üßõ Dracula' },\r\n    { value: 'tomorrow-night-eighties', label: 'üåâ Tomorrow Night' },\r\n    { value: 'base16-dark', label: 'üåÉ Base16 Dark' },\r\n    { value: 'blackboard', label: '‚ö´ Blackboard' },\r\n    { value: 'eclipse', label: 'üåÖ Eclipse' }\r\n  ],\r\n  TEXTAREA: [\r\n    { value: 'default', label: 'üè≥Ô∏è Default' }\r\n  ]\r\n};\r\n","import { LOG_LEVELS, DEFAULT_LOG_LEVEL } from './constants.js';\r\n\r\n/**\r\n * Global logging filter manager for enabling/disabling specific components\r\n */\r\nclass LoggingManager {\r\n  constructor() {\r\n    this.allowedComponents = new Set();\r\n    this.globalEnabled = true;\r\n    this.allowAll = false;\r\n\r\n    // Try to load from localStorage\r\n    this.loadFromStorage();\r\n  }\r\n\r\n  /**\r\n   * Enables logging for specific components\r\n   * @param {...string} components - Component names to enable\r\n   */\r\n  enable(...components) {\r\n    components.forEach(comp => this.allowedComponents.add(comp.toLowerCase()));\r\n    this.saveToStorage();\r\n    console.log('üîß Logging enabled for:', components.join(', '));\r\n  }\r\n\r\n  /**\r\n   * Disables logging for specific components\r\n   * @param {...string} components - Component names to disable\r\n   */\r\n  disable(...components) {\r\n    components.forEach(comp => this.allowedComponents.delete(comp.toLowerCase()));\r\n    this.saveToStorage();\r\n    console.log('üîß Logging disabled for:', components.join(', '));\r\n  }\r\n\r\n  /**\r\n   * Enables logging for all components\r\n   */\r\n  enableAll() {\r\n    this.allowAll = true;\r\n    this.saveToStorage();\r\n    console.log('üîß Logging enabled for ALL components');\r\n  }\r\n\r\n  /**\r\n   * Disables logging for all components except errors\r\n   */\r\n  disableAll() {\r\n    this.allowAll = false;\r\n    this.allowedComponents.clear();\r\n    this.saveToStorage();\r\n    console.log('üîß Logging disabled for ALL components (errors still show)');\r\n  }\r\n\r\n  /**\r\n   * Shows current logging status\r\n   */\r\n  status() {\r\n    console.log('üîß Logging Status:');\r\n    console.log('  Global enabled:', this.globalEnabled);\r\n    console.log('  Allow all:', this.allowAll);\r\n    console.log('  Enabled components:', Array.from(this.allowedComponents).join(', ') || 'none');\r\n  }\r\n\r\n  /**\r\n   * Lists available components that have loggers\r\n   */\r\n  listComponents() {\r\n    console.log('üîß Available components to filter:');\r\n    const components = Array.from(this.registeredComponents || []).sort();\r\n    components.forEach(comp => {\r\n      const enabled = this.isComponentEnabled(comp);\r\n      console.log(`  ${enabled ? '‚úÖ' : '‚ùå'} ${comp}`);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Checks if a component should log\r\n   * @param {string} component - Component name\r\n   * @returns {boolean} True if component should log\r\n   */\r\n  isComponentEnabled(component) {\r\n    if (!this.globalEnabled) return false;\r\n    if (this.allowAll) return true;\r\n    return this.allowedComponents.has(component.toLowerCase());\r\n  }\r\n\r\n  /**\r\n   * Registers a component for tracking\r\n   * @param {string} component - Component name\r\n   */\r\n  registerComponent(component) {\r\n    if (!this.registeredComponents) this.registeredComponents = new Set();\r\n    this.registeredComponents.add(component);\r\n  }\r\n\r\n  /**\r\n   * Saves filter state to localStorage\r\n   */\r\n  saveToStorage() {\r\n    try {\r\n      const state = {\r\n        allowedComponents: Array.from(this.allowedComponents),\r\n        allowAll: this.allowAll,\r\n        globalEnabled: this.globalEnabled\r\n      };\r\n      localStorage.setItem('sandbox_logging_filters', JSON.stringify(state));\r\n    } catch (e) {\r\n      // Ignore localStorage errors\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Loads filter state from localStorage\r\n   */\r\n  loadFromStorage() {\r\n    try {\r\n      const state = JSON.parse(localStorage.getItem('sandbox_logging_filters') || '{}');\r\n      this.allowedComponents = new Set(state.allowedComponents || []);\r\n      this.allowAll = state.allowAll || false;\r\n      this.globalEnabled = state.globalEnabled !== false;\r\n\r\n      // If no saved state exists, set up sensible defaults for theme work\r\n      if (!localStorage.getItem('sandbox_logging_filters')) {\r\n        this.allowedComponents = new Set(['themeswitcher', 'codemirroreditor', 'editoradapter']);\r\n      }\r\n    } catch (e) {\r\n      // Ignore localStorage errors, use defaults\r\n      this.allowedComponents = new Set(['themeswitcher', 'codemirroreditor', 'editoradapter']);\r\n    }\r\n  }\r\n}\r\n\r\n// Global instance\r\nconst loggingManager = new LoggingManager();\r\n\r\n// Expose to window for easy console access\r\nif (typeof window !== 'undefined') {\r\n  window.logFilter = {\r\n    enable: (...components) => loggingManager.enable(...components),\r\n    disable: (...components) => loggingManager.disable(...components),\r\n    enableAll: () => loggingManager.enableAll(),\r\n    disableAll: () => loggingManager.disableAll(),\r\n    status: () => loggingManager.status(),\r\n    list: () => loggingManager.listComponents()\r\n  };\r\n}\r\n\r\n/**\r\n * Configurable logging interface with level-based filtering and prefixes\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\nexport class Logger {\r\n  /**\r\n   * Creates a new Logger instance\r\n   * @param {Object} options - Logger configuration options\r\n   * @param {boolean} [options.enabled=true] - Whether logging is enabled\r\n   * @param {string} [options.level='info'] - Log level (error, warn, info, debug, trace)\r\n   * @param {string} [options.prefix=''] - Prefix to add to all log messages\r\n   * @param {boolean} [options.redactSecrets=false] - Whether to redact potential secrets\r\n   */\r\n  constructor(options = {}) {\r\n    this.enabled = options.enabled !== false;\r\n    this.level = options.level || DEFAULT_LOG_LEVEL;\r\n    this.prefix = options.prefix || '';\r\n    this.component = this.prefix; // Use prefix as component name for filtering\r\n    this.redactSecrets = options.redactSecrets || false;\r\n    this.currentLevel = LOG_LEVELS[this.level.toUpperCase()] ?? LOG_LEVELS.INFO;\r\n\r\n    // Register this component with the global manager\r\n    if (this.component) {\r\n      loggingManager.registerComponent(this.component);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Checks if a message should be logged based on current level, enabled state, and component filter\r\n   * @param {string} level - The log level to check\r\n   * @returns {boolean} True if the message should be logged\r\n   */\r\n  shouldLog(level) {\r\n    // Always allow errors to pass through\r\n    if (level.toUpperCase() === 'ERROR') {\r\n      return this.enabled && LOG_LEVELS[level.toUpperCase()] <= this.currentLevel;\r\n    }\r\n\r\n    // Check if this component is allowed to log\r\n    const componentAllowed = !this.component || loggingManager.isComponentEnabled(this.component);\r\n\r\n    return this.enabled &&\r\n           componentAllowed &&\r\n           LOG_LEVELS[level.toUpperCase()] <= this.currentLevel;\r\n  }\r\n\r\n  /**\r\n   * Redacts potential secrets from arguments\r\n   * @param {Array} args - Arguments to redact\r\n   * @returns {Array} Redacted arguments\r\n   */\r\n  redactArgs(args) {\r\n    if (!this.redactSecrets) return args;\r\n    \r\n    return args.map(arg => {\r\n      if (typeof arg === 'string') {\r\n        // Redact anything that looks like a token/secret (alphanumeric strings > 20 chars)\r\n        return arg.replace(/\\b[a-zA-Z0-9]{20,}\\b/g, '[REDACTED]');\r\n      }\r\n      return arg;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Formats a message with prefix\r\n   * @param {string} message - The message to format\r\n   * @param {...any} args - Additional arguments\r\n   * @returns {Array} Formatted message array\r\n   */\r\n  formatMessage(message, ...args) {\r\n    const prefix = this.prefix ? `[${this.prefix}] ` : '';\r\n    const redactedArgs = this.redactArgs(args);\r\n    return [prefix + message, ...redactedArgs];\r\n  }\r\n\r\n  /**\r\n   * Logs an error message\r\n   * @param {string} message - The error message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  error(message, ...args) {\r\n    if (this.shouldLog('error')) {\r\n      console.error(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a warning message\r\n   * @param {string} message - The warning message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  warn(message, ...args) {\r\n    if (this.shouldLog('warn')) {\r\n      console.warn(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs an info message\r\n   * @param {string} message - The info message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  info(message, ...args) {\r\n    if (this.shouldLog('info')) {\r\n      console.info(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a general message\r\n   * @param {string} message - The message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  log(message, ...args) {\r\n    if (this.shouldLog('info')) {\r\n      console.log(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a debug message\r\n   * @param {string} message - The debug message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  debug(message, ...args) {\r\n    if (this.shouldLog('debug')) {\r\n      console.debug(...this.formatMessage(message, ...args));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a trace message (with secret redaction by default)\r\n   * @param {string} message - The trace message\r\n   * @param {...any} args - Additional arguments\r\n   */\r\n  trace(message, ...args) {\r\n    if (this.shouldLog('trace')) {\r\n      // Always redact for trace logs to avoid leaking secrets\r\n      const wasRedacting = this.redactSecrets;\r\n      this.redactSecrets = true;\r\n      console.trace(...this.formatMessage(message, ...args));\r\n      this.redactSecrets = wasRedacting;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a table of data\r\n   * @param {any} data - The data to display in table format\r\n   * @param {Array} [columns] - Optional column names\r\n   */\r\n  table(data, columns) {\r\n    if (this.shouldLog('info')) {\r\n      const prefix = this.prefix ? `[${this.prefix}]` : '';\r\n      if (prefix) console.log(prefix);\r\n      console.table(data, columns);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Creates a new group in the console\r\n   * @param {string} label - The group label\r\n   */\r\n  group(label) {\r\n    if (this.shouldLog('info')) {\r\n      console.group(...this.formatMessage(label));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Creates a new collapsed group in the console\r\n   * @param {string} label - The group label\r\n   */\r\n  groupCollapsed(label) {\r\n    if (this.shouldLog('info')) {\r\n      console.groupCollapsed(...this.formatMessage(label));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ends the current console group\r\n   */\r\n  groupEnd() {\r\n    if (this.shouldLog('info')) {\r\n      console.groupEnd();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Starts a timer with the given label\r\n   * @param {string} label - The timer label\r\n   */\r\n  time(label) {\r\n    if (this.shouldLog('debug')) {\r\n      console.time(this.prefix ? `[${this.prefix}] ${label}` : label);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ends a timer with the given label\r\n   * @param {string} label - The timer label\r\n   */\r\n  timeEnd(label) {\r\n    if (this.shouldLog('debug')) {\r\n      console.timeEnd(this.prefix ? `[${this.prefix}] ${label}` : label);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets the log level\r\n   * @param {string} level - The new log level\r\n   */\r\n  setLevel(level) {\r\n    this.level = level;\r\n    this.currentLevel = LOG_LEVELS[level.toUpperCase()] ?? LOG_LEVELS.INFO;\r\n  }\r\n\r\n  /**\r\n   * Enables logging\r\n   */\r\n  enable() {\r\n    this.enabled = true;\r\n  }\r\n\r\n  /**\r\n   * Disables logging\r\n   */\r\n  disable() {\r\n    this.enabled = false;\r\n  }\r\n\r\n  /**\r\n   * Checks if logging is enabled\r\n   * @returns {boolean} True if logging is enabled\r\n   */\r\n  isEnabled() {\r\n    return this.enabled;\r\n  }\r\n}\r\n","import { Logger } from '../core/logger.js';\r\nimport { EVENTS } from '../core/constants.js';\r\n\r\n/**\r\n * Base class for editor adapters providing a common interface\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\nexport class EditorAdapter {\r\n  /**\r\n   * Creates a new EditorAdapter instance\r\n   * @param {HTMLElement} container - DOM element to contain the editor\r\n   * @param {Object} [options={}] - Editor configuration options\r\n   * @param {Object} [eventEmitter] - Event emitter for listening to global events\r\n   */\r\n  constructor(container, options = {}, eventEmitter = null) {\r\n    this.container = container;\r\n    this.options = options;\r\n    this.eventEmitter = eventEmitter;\r\n    this.changeHandlers = [];\r\n    this.executeHandlers = [];\r\n    this.inputHandlers = [];\r\n    this.deleteHandlers = [];\r\n\r\n    this.logger = new Logger({\r\n      enabled: true,\r\n      level: 'info',\r\n      prefix: 'EditorAdapter'\r\n    });\r\n\r\n    // Listen for theme events if event emitter is provided\r\n    if (this.eventEmitter) {\r\n      this.logger.info('Setting up theme event listeners');\r\n\r\n      // Listen for theme ready (initial theme load)\r\n      this.eventEmitter.on(EVENTS.THEME_READY, (data) => {\r\n        this.logger.info('Base adapter received theme ready event:', data);\r\n        this.onThemeChange(data.theme, null);\r\n      });\r\n\r\n      // Listen for theme changes (user switching themes)\r\n      this.eventEmitter.on(EVENTS.THEME_CHANGE, (data) => {\r\n        this.logger.info('Base adapter received theme change event:', data);\r\n        this.onThemeChange(data.theme, data.oldTheme);\r\n      });\r\n    } else {\r\n      this.logger.warn('No event emitter provided - theme switching will not work');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the current code value from the editor\r\n   * @returns {string} The current code\r\n   * @throws {Error} Must be implemented by subclass\r\n   */\r\n  getValue() {\r\n    throw new Error('getValue() must be implemented by editor adapter');\r\n  }\r\n\r\n  /**\r\n   * Sets the code value in the editor\r\n   * @param {string} code - The code to set\r\n   * @throws {Error} Must be implemented by subclass\r\n   */\r\n  setValue(code) {\r\n    throw new Error('setValue() must be implemented by editor adapter');\r\n  }\r\n\r\n  /**\r\n   * Registers a callback for code change events\r\n   * @param {Function} callback - Callback function to call when code changes\r\n   */\r\n  onChange(callback) {\r\n    this.changeHandlers.push(callback);\r\n  }\r\n\r\n  /**\r\n   * Registers a callback for code execution events (Ctrl+Enter)\r\n   * @param {Function} callback - Callback function to call when user executes code\r\n   */\r\n  onExecute(callback) {\r\n    this.executeHandlers.push(callback);\r\n  }\r\n\r\n  /**\r\n   * Registers a callback for input events (character typed)\r\n   * @param {Function} callback - Callback function to call when user types\r\n   */\r\n  onInput(callback) {\r\n    this.inputHandlers.push(callback);\r\n  }\r\n\r\n  /**\r\n   * Registers a callback for delete events (backspace/delete)\r\n   * @param {Function} callback - Callback function to call when user deletes\r\n   */\r\n  onDelete(callback) {\r\n    this.deleteHandlers.push(callback);\r\n  }\r\n\r\n  /**\r\n   * Focuses the editor\r\n   * @throws {Error} Must be implemented by subclass\r\n   */\r\n  focus() {\r\n    throw new Error('focus() must be implemented by editor adapter');\r\n  }\r\n\r\n  /**\r\n   * Triggers all registered change handlers\r\n   */\r\n  triggerChange() {\r\n    this.changeHandlers.forEach(handler => handler(this.getValue()));\r\n  }\r\n\r\n  /**\r\n   * Triggers all registered execute handlers\r\n   */\r\n  triggerExecute() {\r\n    this.executeHandlers.forEach(handler => handler());\r\n  }\r\n\r\n  /**\r\n   * Triggers all registered input handlers\r\n   * @param {Object} inputData - Input event data\r\n   */\r\n  triggerInput(inputData) {\r\n    this.inputHandlers.forEach(handler => handler(inputData));\r\n  }\r\n\r\n  /**\r\n   * Triggers all registered delete handlers\r\n   * @param {Object} deleteData - Delete event data\r\n   */\r\n  triggerDelete(deleteData) {\r\n    this.deleteHandlers.forEach(handler => handler(deleteData));\r\n  }\r\n\r\n  /**\r\n   * Applies a transformation to the editor (insert text, move cursor, etc.)\r\n   * @param {Object} transformation - Transformation to apply\r\n   */\r\n  applyTransformation(transformation) {\r\n    // Override in subclasses to implement transformations\r\n    throw new Error('applyTransformation() must be implemented by editor adapter');\r\n  }\r\n\r\n  /**\r\n   * Called when theme changes - override in subclasses\r\n   * @param {string} newTheme - The new theme name\r\n   * @param {string} oldTheme - The previous theme name\r\n   */\r\n  onThemeChange(newTheme, oldTheme) {\r\n    // Override in subclasses to implement theme switching\r\n  }\r\n\r\n  /**\r\n   * Cleans up the editor instance\r\n   * Override if cleanup is needed\r\n   */\r\n  destroy() {\r\n    // Override if cleanup needed\r\n  }\r\n}","/**\r\n * Advanced Autocomplete Features\r\n * \r\n * This file demonstrates how to enhance the basic autocomplete\r\n * with more Chrome DevTools-like features\r\n */\r\n\r\nimport { Logger } from \"../../core/logger\";\r\n\r\nexport class AdvancedAutocomplete {\r\n  constructor(cm, options = {}) {\r\n    this.cm = cm;\r\n    this.options = options;\r\n    this.logger = new Logger({\r\n      enabled: options.debug || false,\r\n      prefix: 'AdvancedAutocomplete'\r\n    });\r\n    \r\n    // Track variables in scope\r\n    this.scopeVariables = new Map();\r\n    \r\n    // Track imported libraries from CDN\r\n    this.loadedLibraries = new Map();\r\n    \r\n    // Initialize scope tracking\r\n    this.initScopeTracking();\r\n  }\r\n\r\n  /**\r\n   * Initialize scope tracking by analyzing code\r\n   */\r\n  initScopeTracking() {\r\n    this.cm.on('change', () => {\r\n      this.analyzeScopeVariables();\r\n    });\r\n    \r\n    // Initial analysis\r\n    this.analyzeScopeVariables();\r\n  }\r\n\r\n  /**\r\n   * Analyze code to extract variable declarations\r\n   */\r\n  analyzeScopeVariables() {\r\n    const code = this.cm.getValue();\r\n    \r\n    // Simple regex patterns for variable detection\r\n    const patterns = {\r\n      // const/let/var declarations\r\n      variables: /(?:const|let|var)\\s+(\\w+)/g,\r\n      // function declarations\r\n      functions: /function\\s+(\\w+)/g,\r\n      // class declarations\r\n      classes: /class\\s+(\\w+)/g,\r\n      // arrow functions assigned to variables\r\n      arrowFunctions: /(?:const|let|var)\\s+(\\w+)\\s*=\\s*(?:\\([^)]*\\)|[^=])\\s*=>/g\r\n    };\r\n    \r\n    this.scopeVariables.clear();\r\n    \r\n    // Extract all declarations\r\n    Object.entries(patterns).forEach(([type, pattern]) => {\r\n      let match;\r\n      while ((match = pattern.exec(code)) !== null) {\r\n        const name = match[1];\r\n        if (name) {\r\n          this.scopeVariables.set(name, {\r\n            type: type,\r\n            line: this.getLineNumber(code, match.index),\r\n            value: this.extractValue(code, match.index)\r\n          });\r\n        }\r\n      }\r\n    });\r\n    \r\n    this.logger.info('Scope analysis complete:', this.scopeVariables.size, 'variables found');\r\n  }\r\n\r\n  /**\r\n   * Get line number from character index\r\n   */\r\n  getLineNumber(text, index) {\r\n    return text.substring(0, index).split('\\n').length - 1;\r\n  }\r\n\r\n  /**\r\n   * Extract the value or type of a variable\r\n   */\r\n  extractValue(code, startIndex) {\r\n    // Simple extraction - could be enhanced\r\n    const snippet = code.substring(startIndex, startIndex + 100);\r\n    const match = snippet.match(/=\\s*([^;,\\n]+)/);\r\n    return match ? match[1].trim() : null;\r\n  }\r\n\r\n  /**\r\n   * Enhanced hint provider with scope awareness\r\n   */\r\n  provideHints(cm, options) {\r\n    const cursor = cm.getCursor();\r\n    const token = cm.getTokenAt(cursor);\r\n    const line = cm.getLine(cursor.line);\r\n    const start = token.start;\r\n    const end = cursor.ch;\r\n    \r\n    let suggestions = [];\r\n    \r\n    // Add scope variables\r\n    if (!line.substring(0, start).endsWith('.')) {\r\n      this.scopeVariables.forEach((info, name) => {\r\n        if (name.toLowerCase().startsWith(token.string.toLowerCase())) {\r\n          suggestions.push({\r\n            text: name,\r\n            displayText: name,\r\n            type: info.type,\r\n            className: 'scope-variable',\r\n            hint: () => cm.replaceRange(name, {line: cursor.line, ch: start}, cursor)\r\n          });\r\n        }\r\n      });\r\n    }\r\n    \r\n    // Add property suggestions for known objects\r\n    if (line.substring(0, start).endsWith('.')) {\r\n      const objMatch = line.substring(0, start - 1).match(/(\\w+)$/);\r\n      if (objMatch) {\r\n        const objName = objMatch[1];\r\n        const objInfo = this.scopeVariables.get(objName);\r\n        \r\n        if (objInfo && objInfo.value) {\r\n          // Provide intelligent suggestions based on value\r\n          suggestions = this.getPropertySuggestions(objInfo.value);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return {\r\n      list: suggestions,\r\n      from: CodeMirror.Pos(cursor.line, start),\r\n      to: CodeMirror.Pos(cursor.line, end)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get property suggestions based on object type\r\n   */\r\n  getPropertySuggestions(value) {\r\n    const suggestions = [];\r\n    \r\n    // Detect array literals\r\n    if (value.startsWith('[')) {\r\n      return ['length', 'push', 'pop', 'map', 'filter', 'reduce', 'forEach'].map(method => ({\r\n        text: method,\r\n        displayText: method + '()',\r\n        className: 'array-method'\r\n      }));\r\n    }\r\n    \r\n    // Detect object literals\r\n    if (value.startsWith('{')) {\r\n      // Could parse the object to get actual properties\r\n      return ['hasOwnProperty', 'toString', 'valueOf'].map(method => ({\r\n        text: method,\r\n        displayText: method + '()',\r\n        className: 'object-method'\r\n      }));\r\n    }\r\n    \r\n    // Detect string literals\r\n    if (value.startsWith('\"') || value.startsWith(\"'\") || value.startsWith('`')) {\r\n      return ['length', 'charAt', 'split', 'substring', 'replace'].map(method => ({\r\n        text: method,\r\n        displayText: method + (method === 'length' ? '' : '()'),\r\n        className: 'string-method'\r\n      }));\r\n    }\r\n    \r\n    return suggestions;\r\n  }\r\n}\r\n\r\n/**\r\n * Type inference system for better autocomplete\r\n */\r\nexport class TypeInference {\r\n  constructor() {\r\n    this.typeMap = new Map();\r\n  }\r\n\r\n  /**\r\n   * Infer type from value\r\n   */\r\n  inferType(value) {\r\n    if (!value) return 'any';\r\n    \r\n    // String literals\r\n    if (/^[\"'`]/.test(value)) return 'string';\r\n    \r\n    // Number literals\r\n    if (/^\\d+(\\.\\d+)?$/.test(value)) return 'number';\r\n    \r\n    // Boolean literals\r\n    if (/^(true|false)$/.test(value)) return 'boolean';\r\n    \r\n    // Array literals\r\n    if (/^\\[/.test(value)) return 'array';\r\n    \r\n    // Object literals\r\n    if (/^\\{/.test(value)) return 'object';\r\n    \r\n    // Function expressions\r\n    if (/^function/.test(value) || /^=>/.test(value)) return 'function';\r\n    \r\n    // Constructor calls\r\n    if (/^new\\s+(\\w+)/.test(value)) {\r\n      const match = value.match(/^new\\s+(\\w+)/);\r\n      return match[1].toLowerCase();\r\n    }\r\n    \r\n    return 'any';\r\n  }\r\n}\r\n\r\n/**\r\n * Documentation provider for hover hints\r\n */\r\nexport class DocumentationProvider {\r\n  constructor() {\r\n    this.docs = {\r\n      'console.log': {\r\n        signature: 'console.log(...data: any[]): void',\r\n        description: 'Outputs a message to the console',\r\n        example: 'console.log(\"Hello\", \"World\");'\r\n      },\r\n      'Array.prototype.map': {\r\n        signature: 'map<U>(callbackfn: (value: T, index: number, array: T[]) => U): U[]',\r\n        description: 'Creates a new array with the results of calling a provided function on every element',\r\n        example: '[1, 2, 3].map(x => x * 2); // [2, 4, 6]'\r\n      },\r\n      // Add more documentation entries\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get documentation for a symbol\r\n   */\r\n  getDocumentation(symbol) {\r\n    return this.docs[symbol] || null;\r\n  }\r\n}\r\n\r\n// CSS for advanced autocomplete features\r\nexport const advancedStyles = `\r\n  /* Scope variables */\r\n  .CodeMirror-hint.scope-variable {\r\n    padding-left: 20px;\r\n    position: relative;\r\n  }\r\n  \r\n  .CodeMirror-hint.scope-variable:before {\r\n    content: \"üì¶\";\r\n    position: absolute;\r\n    left: 4px;\r\n  }\r\n  \r\n  /* Type indicators */\r\n  .CodeMirror-hint.string-method:before {\r\n    content: \"üìù\";\r\n  }\r\n  \r\n  .CodeMirror-hint.array-method:before {\r\n    content: \"üìã\";\r\n  }\r\n  \r\n  .CodeMirror-hint.object-method:before {\r\n    content: \"üì¶\";\r\n  }\r\n  \r\n  /* Documentation popup */\r\n  .cm-documentation-popup {\r\n    position: absolute;\r\n    background: rgba(30, 30, 30, 0.95);\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n    border-radius: 4px;\r\n    padding: 8px 12px;\r\n    font-size: 12px;\r\n    max-width: 400px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\r\n    backdrop-filter: blur(10px);\r\n  }\r\n  \r\n  .cm-documentation-popup .signature {\r\n    color: #61afef;\r\n    font-family: monospace;\r\n    margin-bottom: 4px;\r\n  }\r\n  \r\n  .cm-documentation-popup .description {\r\n    color: #abb2bf;\r\n    margin-bottom: 4px;\r\n  }\r\n  \r\n  .cm-documentation-popup .example {\r\n    color: #98c379;\r\n    font-family: monospace;\r\n    background: rgba(0, 0, 0, 0.3);\r\n    padding: 4px;\r\n    border-radius: 2px;\r\n  }\r\n`;\r\n","import { Logger } from '../core/logger.js';\r\n\r\n/**\r\n * Universal Input Manager - Handles input transformations for all editor types\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\nexport class InputManager {\r\n  /**\r\n   * Creates a new InputManager instance\r\n   * @param {Object} options - Configuration options\r\n   * @param {boolean} [options.debug=false] - Enable debug logging\r\n   */\r\n  constructor(options = {}) {\r\n    this.options = {\r\n      debug: false,\r\n      ...options\r\n    };\r\n\r\n    this.logger = new Logger({\r\n      enabled: this.options.debug,\r\n      level: 'info',\r\n      prefix: 'InputManager'\r\n    });\r\n\r\n    // Bracket pairs for auto-closing\r\n    this.bracketPairs = new Map([\r\n      ['(', ')'],\r\n      ['[', ']'],\r\n      ['{', '}'],\r\n      ['\"', '\"'],\r\n      [\"'\", \"'\"],\r\n      ['`', '`']\r\n    ]);\r\n\r\n    this.logger.info('InputManager initialized');\r\n  }\r\n\r\n  /**\r\n   * Handle character input and return transformation if needed\r\n   * @param {Object} inputData - Input event data\r\n   * @param {string} inputData.char - Character that was typed\r\n   * @param {number} inputData.position - Cursor position\r\n   * @param {string} inputData.line - Current line content\r\n   * @param {number} inputData.lineNumber - Line number\r\n   * @returns {Object|null} Transformation object or null if no transformation\r\n   */\r\n  handleInput(inputData) {\r\n    const { char, position, line } = inputData;\r\n\r\n    this.logger.debug(`Handling input: \"${char}\" at position ${position}`);\r\n\r\n    // Handle opening brackets/quotes\r\n    if (this.bracketPairs.has(char)) {\r\n      const closeChar = this.bracketPairs.get(char);\r\n\r\n      if (this.shouldAutoClose(inputData, closeChar)) {\r\n        this.logger.debug(`Auto-closing ${char} with ${closeChar}`);\r\n        return {\r\n          action: 'insert',\r\n          text: closeChar,\r\n          cursorOffset: -1 // Move cursor back to be between brackets\r\n        };\r\n      }\r\n    }\r\n\r\n    // Handle closing brackets - skip if already there\r\n    if (Array.from(this.bracketPairs.values()).includes(char)) {\r\n      const charAfter = line.charAt(position);\r\n      if (charAfter === char) {\r\n        this.logger.debug(`Skipping over existing ${char}`);\r\n        return {\r\n          action: 'skip',\r\n          positions: 1 // Move cursor forward 1 position\r\n        };\r\n      }\r\n    }\r\n\r\n    return null; // No transformation needed\r\n  }\r\n\r\n  /**\r\n   * Handle delete operations (backspace/delete)\r\n   * @param {Object} deleteData - Delete event data\r\n   * @param {string} deleteData.type - 'backspace' or 'delete'\r\n   * @param {number} deleteData.position - Cursor position\r\n   * @param {string} deleteData.line - Current line content\r\n   * @returns {Object|null} Transformation object or null if no transformation\r\n   */\r\n  handleDelete(deleteData) {\r\n    const { type, position, line } = deleteData;\r\n\r\n    if (type === 'backspace') {\r\n      const charBefore = line.charAt(position - 1);\r\n      const charAfter = line.charAt(position);\r\n\r\n      // Check for empty bracket pairs\r\n      for (const [open, close] of this.bracketPairs) {\r\n        if (charBefore === open && charAfter === close) {\r\n          this.logger.debug(`Deleting empty bracket pair: ${open}${close}`);\r\n          return {\r\n            action: 'deleteRange',\r\n            start: position - 1,\r\n            end: position + 1\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    return null; // No transformation needed\r\n  }\r\n\r\n  /**\r\n   * Determine if a bracket should be auto-closed\r\n   * @param {Object} inputData - Input event data\r\n   * @param {string} closeChar - The closing character to potentially insert\r\n   * @returns {boolean} Whether to auto-close\r\n   */\r\n  shouldAutoClose(inputData, closeChar) {\r\n    const { char, position, line } = inputData;\r\n\r\n    const charAfter = line.charAt(position);\r\n    const charBefore = line.charAt(position - 1);\r\n\r\n    // For quotes, don't auto-close if we're inside a word\r\n    if (['\"', \"'\", '`'].includes(char)) {\r\n      if (/\\w/.test(charBefore) && /\\w/.test(charAfter)) {\r\n        return false;\r\n      }\r\n\r\n      // If next char is the same quote, we'll skip it instead\r\n      if (charAfter === char) {\r\n        return false; // Let the skip logic handle this\r\n      }\r\n    }\r\n\r\n    // Auto-close if:\r\n    // - End of line\r\n    // - Next char is whitespace\r\n    // - Next char is punctuation/closing bracket\r\n    return !charAfter ||\r\n           /\\s/.test(charAfter) ||\r\n           [')', ']', '}', ',', ';', '.'].includes(charAfter);\r\n  }\r\n\r\n  /**\r\n   * Get debug information about current bracket state\r\n   * @param {string} line - Current line\r\n   * @param {number} position - Cursor position\r\n   * @returns {Object} Debug info\r\n   */\r\n  getDebugInfo(line, position) {\r\n    return {\r\n      charBefore: line.charAt(position - 1) || 'none',\r\n      charAfter: line.charAt(position) || 'none',\r\n      position,\r\n      lineLength: line.length,\r\n      nearContext: line.substring(Math.max(0, position - 3), position + 3)\r\n    };\r\n  }\r\n}","import { EditorAdapter } from './base.js';\r\nimport { Logger } from '../core/logger.js';\r\nimport { setupAutocomplete, autocompleteStyles } from './autocomplete/setup.js';\r\nimport { AdvancedAutocomplete } from './autocomplete/advanced.js';\r\nimport { InputManager } from './input.js';\r\n\r\n/**\r\n * CodeMirror editor adapter with syntax highlighting and advanced features\r\n * @author Joao Guilherme (Guinetik) <guinetik@gmail.com>\r\n */\r\nexport class CodeMirrorEditor extends EditorAdapter {\r\n  /**\r\n   * Creates a new CodeMirrorEditor instance\r\n   * @param {HTMLElement} container - DOM element to contain the editor\r\n   * @param {Object} [options={}] - Editor configuration options\r\n   * @param {string} [options.mode='javascript'] - CodeMirror language mode\r\n   * @param {string} [options.theme='darcula'] - CodeMirror theme\r\n   * @param {boolean} [options.autofocus=true] - Whether to autofocus the editor\r\n   * @param {Object} [eventEmitter] - Event emitter for listening to global events\r\n   */\r\n  constructor(container, options = {}, eventEmitter = null) {\r\n    super(container, options, eventEmitter);\r\n    this.cm = null;\r\n    this.currentTheme = options.theme || 'darcula';\r\n\r\n    this.logger = new Logger({\r\n      enabled: true,\r\n      level: 'info',\r\n      prefix: 'CodeMirrorEditor'\r\n    });\r\n\r\n    // Initialize InputManager\r\n    this.inputManager = new InputManager({\r\n      debug: options.debug || false\r\n    });\r\n\r\n    this.logger.info('CodeMirror editor initialized with theme:', this.currentTheme);\r\n    this.logger.info('Event emitter provided:', !!eventEmitter);\r\n\r\n    this.init();\r\n    this.setupInputHandling();\r\n  }\r\n\r\n  /**\r\n   * Initializes the CodeMirror editor instance\r\n   * @throws {Error} If CodeMirror is not loaded\r\n   */\r\n  init() {\r\n    if (typeof CodeMirror === 'undefined') {\r\n      throw new Error('CodeMirror is not loaded. Include CodeMirror before using this adapter.');\r\n    }\r\n\r\n    const textarea = document.createElement('textarea');\r\n    this.container.appendChild(textarea);\r\n\r\n    this.cm = CodeMirror.fromTextArea(textarea, {\r\n      mode: this.options.mode || 'javascript',\r\n      theme: this.currentTheme,\r\n      lineNumbers: true,\r\n      lineWrapping: true,\r\n      indentUnit: 2,\r\n      tabSize: 2,\r\n      indentWithTabs: false,\r\n      autofocus: this.options.autofocus !== false,\r\n      extraKeys: {\r\n        'Ctrl-Enter': () => this.triggerExecute(),\r\n        'Cmd-Enter': () => this.triggerExecute()\r\n      }\r\n    });\r\n\r\n    this.cm.on('change', () => {\r\n      this.triggerChange();\r\n    });\r\n\r\n    // Setup autocomplete if enabled\r\n    if (this.options.autocomplete !== false) {\r\n      this.setupAutocomplete();\r\n    }\r\n\r\n    // Apply glass effect on initial load\r\n    this.applyGlassEffect(this.currentTheme);\r\n  }\r\n\r\n  /**\r\n   * Gets the current code value from CodeMirror\r\n   * @returns {string} The current code\r\n   */\r\n  getValue() {\r\n    return this.cm.getValue();\r\n  }\r\n\r\n  /**\r\n   * Sets the code value in CodeMirror\r\n   * @param {string} code - The code to set\r\n   */\r\n  setValue(code) {\r\n    this.cm.setValue(code);\r\n  }\r\n\r\n  /**\r\n   * Focuses the CodeMirror editor\r\n   */\r\n  focus() {\r\n    this.cm.focus();\r\n  }\r\n\r\n  /**\r\n   * Handles theme change events\r\n   * @param {string} newTheme - The new theme name\r\n   * @param {string} oldTheme - The previous theme name\r\n   */\r\n  onThemeChange(newTheme, oldTheme) {\r\n    this.logger.info('onThemeChange called with:', { newTheme, oldTheme });\r\n    this.logger.info('Current theme before change:', this.currentTheme);\r\n    this.logger.info('CodeMirror instance exists:', !!this.cm);\r\n\r\n    if (this.cm && newTheme !== this.currentTheme) {\r\n      this.logger.info('Applying theme change from', this.currentTheme, 'to', newTheme);\r\n      this.currentTheme = newTheme;\r\n      this.cm.setOption('theme', newTheme);\r\n      this.logger.info('Theme applied successfully. CodeMirror theme is now:', this.cm.getOption('theme'));\r\n\r\n      // Apply glass glow effect by reducing background opacity\r\n      this.applyGlassEffect(newTheme);\r\n    } else {\r\n      this.logger.warn('Theme change skipped. Reasons:');\r\n      this.logger.warn('- CodeMirror exists:', !!this.cm);\r\n      this.logger.warn('- New theme different from current:', newTheme !== this.currentTheme);\r\n      this.logger.warn('- New theme value:', newTheme);\r\n      this.logger.warn('- Current theme value:', this.currentTheme);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Applies glass effect by reducing CodeMirror background opacity\r\n   * @param {string} theme - The current theme name\r\n   */\r\n  applyGlassEffect(theme) {\r\n    // Wait for theme to be applied, then modify background opacity\r\n    setTimeout(() => {\r\n      const cmElement = this.container.querySelector('.CodeMirror');\r\n      if (cmElement) {\r\n        this.logger.info('Applying glass effect for theme:', theme);\r\n\r\n        // Get the computed background color from the theme\r\n        const computedStyle = window.getComputedStyle(cmElement);\r\n        const backgroundColor = computedStyle.backgroundColor;\r\n        this.logger.info('Original background color:', backgroundColor);\r\n\r\n        // Parse the color and reduce opacity to 70% (not 50% - too transparent)\r\n        const reducedOpacityColor = this.reduceColorOpacity(backgroundColor, 0.7);\r\n        this.logger.info('Reduced opacity color:', reducedOpacityColor);\r\n\r\n        // Create or update style element for glass effect\r\n        let styleElement = document.getElementById('codemirror-glass-effect');\r\n        if (!styleElement) {\r\n          styleElement = document.createElement('style');\r\n          styleElement.id = 'codemirror-glass-effect';\r\n          document.head.appendChild(styleElement);\r\n        }\r\n\r\n        // Apply reduced opacity background to let glow show through\r\n        const themeClass = `.cm-s-${theme}`;\r\n        styleElement.textContent = `\r\n          ${themeClass}.CodeMirror {\r\n            background-color: ${reducedOpacityColor} !important;\r\n          }\r\n          ${themeClass} .CodeMirror-gutters {\r\n            background-color: ${this.reduceColorOpacity(backgroundColor, 0.8)} !important;\r\n          }\r\n        `;\r\n\r\n        this.logger.info('Glass effect applied with reduced opacity background');\r\n      }\r\n    }, 200); // Slightly longer delay to ensure theme CSS is fully loaded\r\n  }\r\n\r\n  /**\r\n   * Reduces the opacity of a CSS color value\r\n   * @param {string} color - The CSS color value (rgb, rgba, hex, etc.)\r\n   * @param {number} opacity - The target opacity (0-1)\r\n   * @returns {string} The color with reduced opacity in rgba format\r\n   */\r\n  reduceColorOpacity(color, opacity) {\r\n    // Handle rgba format\r\n    const rgbaMatch = color.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/);\r\n    if (rgbaMatch) {\r\n      const [, r, g, b] = rgbaMatch;\r\n      return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n    }\r\n\r\n    // Handle rgb format\r\n    const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\r\n    if (rgbMatch) {\r\n      const [, r, g, b] = rgbMatch;\r\n      return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n    }\r\n\r\n    // Handle hex format\r\n    const hexMatch = color.match(/^#([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i);\r\n    if (hexMatch) {\r\n      const r = parseInt(hexMatch[1], 16);\r\n      const g = parseInt(hexMatch[2], 16);\r\n      const b = parseInt(hexMatch[3], 16);\r\n      return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n    }\r\n\r\n    // Fallback for other formats or if parsing fails\r\n    this.logger.warn('Could not parse color:', color, 'using fallback');\r\n    return `rgba(0, 0, 0, ${opacity})`;\r\n  }\r\n\r\n  /**\r\n   * Gets the current theme\r\n   * @returns {string} Current theme name\r\n   */\r\n  getCurrentTheme() {\r\n    return this.currentTheme;\r\n  }\r\n\r\n  /**\r\n   * Sets the theme programmatically\r\n   * @param {string} theme - Theme name to set\r\n   */\r\n  setTheme(theme) {\r\n    if (this.cm && theme !== this.currentTheme) {\r\n      this.currentTheme = theme;\r\n      this.cm.setOption('theme', theme);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets up autocomplete functionality\r\n   */\r\n  setupAutocomplete() {\r\n    this.logger.info('Setting up autocomplete');\r\n\r\n    // Inject autocomplete styles\r\n    if (!document.getElementById('codemirror-autocomplete-styles')) {\r\n      const styleElement = document.createElement('style');\r\n      styleElement.id = 'codemirror-autocomplete-styles';\r\n      styleElement.textContent = autocompleteStyles;\r\n      document.head.appendChild(styleElement);\r\n    }\r\n\r\n    // Setup autocomplete functionality\r\n    const autocompleteSetup = setupAutocomplete(this.cm, {\r\n      autoComplete: true\r\n    });\r\n\r\n    this.advancedAutocomplete = new AdvancedAutocomplete(this.cm, {\r\n      debug: this.options.debug\r\n    });\r\n\r\n    // Connect the two systems so setup can access scope variables\r\n    if (autocompleteSetup && autocompleteSetup.setAdvancedInstance) {\r\n      autocompleteSetup.setAdvancedInstance(this.advancedAutocomplete);\r\n    }\r\n\r\n    this.logger.info('Autocomplete setup complete');\r\n  }\r\n\r\n  /**\r\n   * Set up input handling with InputManager\r\n   */\r\n  setupInputHandling() {\r\n    this.logger.info('Setting up input handling');\r\n\r\n    // Listen for input events from CodeMirror\r\n    this.cm.on('inputRead', (cm, change) => {\r\n      if (change.text.length === 1 && change.text[0]) {\r\n        const char = change.text[0];\r\n        const cursor = cm.getCursor();\r\n        const line = cm.getLine(cursor.line);\r\n\r\n        const inputData = {\r\n          char,\r\n          position: cursor.ch - 1, // Position before the character was inserted\r\n          line: line.substring(0, cursor.ch - 1) + line.substring(cursor.ch), // Line before insertion\r\n          lineNumber: cursor.line\r\n        };\r\n\r\n        this.logger.debug('Input event:', inputData);\r\n\r\n        // Get transformation from InputManager\r\n        const transformation = this.inputManager.handleInput(inputData);\r\n        if (transformation) {\r\n          this.applyTransformation(transformation);\r\n        }\r\n\r\n        // Trigger the adapter event for external listeners\r\n        this.triggerInput(inputData);\r\n      }\r\n    });\r\n\r\n    // Listen for delete operations\r\n    this.cm.on('beforeChange', (cm, change) => {\r\n      if (change.origin === '+delete' || change.origin === 'delete') {\r\n        const cursor = cm.getCursor();\r\n        const line = cm.getLine(cursor.line);\r\n\r\n        const deleteData = {\r\n          type: 'backspace', // or 'delete' depending on the operation\r\n          position: cursor.ch,\r\n          line,\r\n          lineNumber: cursor.line\r\n        };\r\n\r\n        this.logger.debug('Delete event:', deleteData);\r\n\r\n        // Get transformation from InputManager\r\n        const transformation = this.inputManager.handleDelete(deleteData);\r\n        if (transformation) {\r\n          // We need to apply this in the next tick to avoid conflicts\r\n          setTimeout(() => this.applyTransformation(transformation), 0);\r\n        }\r\n\r\n        // Trigger the adapter event for external listeners\r\n        this.triggerDelete(deleteData);\r\n      }\r\n    });\r\n\r\n    this.logger.info('Input handling setup complete');\r\n  }\r\n\r\n  /**\r\n   * Apply a transformation to the CodeMirror editor\r\n   * @param {Object} transformation - Transformation to apply\r\n   */\r\n  applyTransformation(transformation) {\r\n    this.logger.debug('Applying transformation:', transformation);\r\n\r\n    const cursor = this.cm.getCursor();\r\n\r\n    switch (transformation.action) {\r\n      case 'insert':\r\n        this.cm.replaceSelection(transformation.text);\r\n        if (transformation.cursorOffset !== undefined) {\r\n          const newCursor = this.cm.getCursor();\r\n          this.cm.setCursor(newCursor.line, newCursor.ch + transformation.cursorOffset);\r\n        }\r\n        break;\r\n\r\n      case 'skip':\r\n        this.cm.setCursor(cursor.line, cursor.ch + transformation.positions);\r\n        break;\r\n\r\n      case 'deleteRange':\r\n        this.cm.replaceRange('',\r\n          { line: cursor.line, ch: transformation.start },\r\n          { line: cursor.line, ch: transformation.end }\r\n        );\r\n        break;\r\n\r\n      default:\r\n        this.logger.warn('Unknown transformation action:', transformation.action);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Cleans up the CodeMirror editor by converting back to textarea\r\n   */\r\n  destroy() {\r\n    if (this.cm) {\r\n      this.cm.toTextArea();\r\n    }\r\n  }\r\n}","/**\r\n * Autocomplete setup for CodeMirror\r\n * Provides intelligent code completion for JavaScript\r\n */\r\n\r\nexport function setupAutocomplete(cm, options = {}) {\r\n  // Store reference to advanced autocomplete instance for scope access\r\n  let advancedAutocomplete = null;\r\n  // JavaScript keywords\r\n  const jsKeywords = [\r\n    'async', 'await', 'break', 'case', 'catch', 'class', 'const', 'continue',\r\n    'debugger', 'default', 'delete', 'do', 'else', 'export', 'extends', 'finally',\r\n    'for', 'function', 'if', 'import', 'in', 'instanceof', 'let', 'new', 'return',\r\n    'super', 'switch', 'this', 'throw', 'try', 'typeof', 'var', 'void', 'while',\r\n    'with', 'yield', 'true', 'false', 'null', 'undefined'\r\n  ];\r\n\r\n  // Browser globals\r\n  const browserGlobals = [\r\n    'document', 'window', 'console', 'navigator', 'location', 'history',\r\n    'localStorage', 'sessionStorage', 'fetch', 'Promise', 'Array', 'Object',\r\n    'String', 'Number', 'Boolean', 'Date', 'RegExp', 'Math', 'JSON',\r\n    'setTimeout', 'setInterval', 'clearTimeout', 'clearInterval',\r\n    'requestAnimationFrame', 'cancelAnimationFrame'\r\n  ];\r\n\r\n\r\n  /**\r\n   * Runtime introspection - discover methods from actual browser objects\r\n   */\r\n  function getObjectMethods(obj, prototype = null) {\r\n    if (!obj) return [];\r\n\r\n    const methods = new Set();\r\n\r\n    // Get methods from the object instance\r\n    Object.getOwnPropertyNames(obj).forEach(name => {\r\n      try {\r\n        if (typeof obj[name] === 'function' && !name.startsWith('_')) {\r\n          methods.add(name);\r\n        }\r\n      } catch (e) {\r\n        // Some properties might throw when accessed\r\n      }\r\n    });\r\n\r\n    // Get methods from prototype if provided\r\n    if (prototype) {\r\n      Object.getOwnPropertyNames(prototype).forEach(name => {\r\n        try {\r\n          if (typeof prototype[name] === 'function' &&\r\n              name !== 'constructor' && !name.startsWith('_')) {\r\n            methods.add(name);\r\n          }\r\n        } catch (e) {\r\n          // Some properties might throw when accessed\r\n        }\r\n      });\r\n    }\r\n\r\n    // Also walk up the prototype chain for more methods\r\n    let currentProto = prototype || Object.getPrototypeOf(obj);\r\n    while (currentProto && currentProto !== Object.prototype) {\r\n      try {\r\n        Object.getOwnPropertyNames(currentProto).forEach(name => {\r\n          try {\r\n            if (typeof currentProto[name] === 'function' &&\r\n                name !== 'constructor' && !name.startsWith('_')) {\r\n              methods.add(name);\r\n            }\r\n          } catch (e) {\r\n            // Some properties might throw when accessed\r\n          }\r\n        });\r\n        currentProto = Object.getPrototypeOf(currentProto);\r\n      } catch (e) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    return Array.from(methods).sort();\r\n  }\r\n\r\n  // Get methods from actual browser objects\r\n  const consoleMethods = getObjectMethods(console);\r\n  const windowMethods = getObjectMethods(window, Window.prototype);\r\n  const documentMethods = getObjectMethods(document, Document.prototype);\r\n  const arrayMethods = getObjectMethods([], Array.prototype);\r\n  const stringMethods = getObjectMethods('', String.prototype);\r\n  const mathMethods = getObjectMethods(Math);\r\n\r\n  // Debug: Verify runtime introspection worked\r\n  console.log('üîç Autocomplete setup complete:');\r\n  console.log('  - Window methods:', windowMethods.length);\r\n  console.log('  - Document methods:', documentMethods.length);\r\n  console.log('  - Console methods:', consoleMethods.length);\r\n\r\n  // Cache commonly used object methods for performance\r\n  const methodCache = {\r\n    console: consoleMethods,\r\n    window: windowMethods,\r\n    document: documentMethods,\r\n    Array: arrayMethods,\r\n    String: stringMethods,\r\n    Math: mathMethods,\r\n    // Add more as needed\r\n    localStorage: getObjectMethods(localStorage, Storage.prototype),\r\n    sessionStorage: getObjectMethods(sessionStorage, Storage.prototype),\r\n    navigator: getObjectMethods(navigator, Navigator.prototype),\r\n    location: getObjectMethods(location, Location.prototype)\r\n  };\r\n\r\n  // Custom hint function\r\n  function javascriptHint(cm, options) {\r\n    const cursor = cm.getCursor();\r\n    const token = cm.getTokenAt(cursor);\r\n    const start = token.start;\r\n    const end = cursor.ch;\r\n    const line = cursor.line;\r\n    const currentWord = token.string;\r\n\r\n    // Get the full line up to cursor position\r\n    const fullTextToCursor = cm.getLine(line).substring(0, end);\r\n\r\n    let suggestions = [];\r\n\r\n    // Check if we're after a dot (property access)\r\n    // Look for pattern: object.partial_method where cursor is after the partial method\r\n    const dotMatch = fullTextToCursor.match(/(\\w+)\\.(\\w*)$/);\r\n\r\n    if (dotMatch) {\r\n      const objectName = dotMatch[1];\r\n      const partialMethod = dotMatch[2] || '';\r\n\r\n      console.log(`üîç Object access: ${objectName}.${partialMethod}`);\r\n\r\n      // Provide context-specific completions using runtime introspection\r\n      if (methodCache[objectName]) {\r\n        let allMethods = methodCache[objectName];\r\n        console.log(`üîç Found ${allMethods.length} methods for ${objectName}`);\r\n\r\n        // Filter methods based on what user has typed after the dot\r\n        if (partialMethod) {\r\n          suggestions = allMethods.filter(method =>\r\n            method.toLowerCase().startsWith(partialMethod.toLowerCase())\r\n          );\r\n          console.log(`üîç Filtered to ${suggestions.length} methods for \"${partialMethod}\":`, suggestions.slice(0, 5));\r\n        } else {\r\n          suggestions = allMethods;\r\n        }\r\n      } else if (objectName === 'Array') {\r\n        suggestions = methodCache.Array;\r\n      } else if (objectName === 'String' || textBefore.match(/[\"'].*[\"']\\.$/)) {\r\n        suggestions = methodCache.String;\r\n      } else {\r\n        // Try to introspect the object dynamically\r\n        try {\r\n          const globalObj = window[objectName];\r\n          if (globalObj) {\r\n            suggestions = getObjectMethods(globalObj, globalObj.constructor?.prototype);\r\n          } else {\r\n            // Fallback to generic object methods\r\n            suggestions = getObjectMethods({}, Object.prototype);\r\n          }\r\n        } catch (e) {\r\n          // Fallback to basic object methods\r\n          suggestions = ['toString', 'valueOf', 'hasOwnProperty', 'constructor'];\r\n        }\r\n      }\r\n    } else {\r\n      // Not after a dot - suggest globals, keywords, and user variables\r\n      const allSuggestions = [...jsKeywords, ...browserGlobals];\r\n\r\n      // Add user-defined variables from scope analysis\r\n      if (advancedAutocomplete && advancedAutocomplete.scopeVariables) {\r\n        const userVariables = Array.from(advancedAutocomplete.scopeVariables.keys());\r\n        allSuggestions.push(...userVariables);\r\n      }\r\n\r\n      if (currentWord) {\r\n        suggestions = allSuggestions.filter(item =>\r\n          item.toLowerCase().startsWith(currentWord.toLowerCase())\r\n        );\r\n      } else {\r\n        suggestions = allSuggestions;\r\n      }\r\n    }\r\n\r\n    // Calculate the correct start position for replacement\r\n    let replaceStart = start;\r\n    let replaceEnd = end;\r\n\r\n    if (dotMatch) {\r\n      // For object.method completion, only replace the method part\r\n      const dotIndex = fullTextToCursor.lastIndexOf('.');\r\n      replaceStart = dotIndex + 1;\r\n    }\r\n\r\n    return {\r\n      list: suggestions.map(text => ({\r\n        text: text,\r\n        displayText: text,\r\n        className: 'autocomplete-item',\r\n        render: (element, self, data) => {\r\n          element.textContent = data.displayText;\r\n          if (jsKeywords.includes(data.text)) {\r\n            element.className += ' keyword';\r\n          } else if (browserGlobals.includes(data.text)) {\r\n            element.className += ' global';\r\n          } else if (advancedAutocomplete && advancedAutocomplete.scopeVariables &&\r\n                    advancedAutocomplete.scopeVariables.has(data.text)) {\r\n            element.className += ' user-variable';\r\n          } else {\r\n            element.className += ' method';\r\n          }\r\n        }\r\n      })),\r\n      from: CodeMirror.Pos(line, replaceStart),\r\n      to: CodeMirror.Pos(line, replaceEnd)\r\n    };\r\n  }\r\n\r\n  // Register the hint function\r\n  CodeMirror.registerHelper('hint', 'javascript', javascriptHint);\r\n\r\n  // Configure autocomplete - clean and simple\r\n  const existingKeys = cm.getOption('extraKeys') || {};\r\n  cm.setOption('extraKeys', {\r\n    ...existingKeys,\r\n    'Ctrl-Space': 'autocomplete',\r\n    '.': function(cm) {\r\n      cm.replaceSelection('.');\r\n      // Trigger autocomplete immediately for object methods\r\n      cm.execCommand('autocomplete');\r\n    }\r\n  });\r\n\r\n  // Simple auto-trigger for word completion\r\n  cm.on('inputRead', function(cm, change) {\r\n    // Only trigger on word characters, not special chars\r\n    if (change.text[0] && /[a-zA-Z]/.test(change.text[0])) {\r\n      cm.execCommand('autocomplete');\r\n    }\r\n  });\r\n\r\n  // Return a function to set the advanced autocomplete instance\r\n  return {\r\n    setAdvancedInstance: (instance) => {\r\n      advancedAutocomplete = instance;\r\n    },\r\n    hint: javascriptHint\r\n  };\r\n}\r\n\r\n// CSS for autocomplete styling\r\nexport const autocompleteStyles = `\r\n  .CodeMirror-hints {\r\n    position: absolute;\r\n    z-index: 10;\r\n    overflow: hidden;\r\n    list-style: none;\r\n    margin: 0;\r\n    padding: 2px;\r\n    background: #1e1e1e;\r\n    border: 1px solid #444;\r\n    border-radius: 4px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\r\n    font-family: monospace;\r\n    font-size: 90%;\r\n    max-height: 20em;\r\n    overflow-y: auto;\r\n  }\r\n\r\n  .CodeMirror-hint {\r\n    margin: 0;\r\n    padding: 4px 8px;\r\n    border-radius: 2px;\r\n    white-space: pre;\r\n    cursor: pointer;\r\n  }\r\n\r\n  .CodeMirror-hint-active {\r\n    background: #2a2a2a;\r\n    color: #fff;\r\n  }\r\n\r\n  .autocomplete-item {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  .autocomplete-item.keyword {\r\n    color: #c678dd;\r\n  }\r\n\r\n  .autocomplete-item.global {\r\n    color: #61afef;\r\n  }\r\n\r\n  .autocomplete-item.method {\r\n    color: #e06c75;\r\n  }\r\n\r\n  .autocomplete-item.user-variable {\r\n    color: #ffffff;\r\n    font-weight: 500;\r\n  }\r\n\r\n  /* Integrate with your neon glow theme */\r\n  .CodeMirror-hints {\r\n    backdrop-filter: blur(10px);\r\n    background: rgba(30, 30, 30, 0.9);\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n  }\r\n`;\r\n"],"names":["DEFAULT_TIMEOUT_MS","NETWORK_TIMEOUT_MS","TEMPLATE_LOAD_TIMEOUT_MS","MIN_LEFT_PANE_WIDTH","MIN_RIGHT_PANE_WIDTH","MIN_CONSOLE_HEIGHT","MIN_PREVIEW_HEIGHT","RESIZE_HANDLE_WIDTH","DEFAULT_STORAGE_KEY","LOG_LEVELS","ERROR","WARN","INFO","DEBUG","TRACE","MOBILE_BREAKPOINT","DEFAULT_EXAMPLES_PATH","baseTag","document","querySelector","href","URL","pathname","window","location","includes","getBasePath","DEFAULT_TEMPLATE_PATH","EVENTS","INIT_START","INIT_COMPLETE","INIT_ERROR","CODE_CHANGE","CODE_LOAD","CODE_VALIDATE","CODE_EXECUTE_START","CODE_EXECUTE_COMPLETE","CODE_EXECUTE_TIMEOUT","CONSOLE_MESSAGE","CONSOLE_CLEAR","SANDBOX_RESET","STATUS_CHANGE","THEME_LOAD_START","THEME_LOAD_COMPLETE","THEME_CHANGE","THEME_READY","EDITOR_READY","EDITOR_CHANGE","EDITOR_CHANGED","EXAMPLE_LOAD","EXAMPLE_LOADED","EXAMPLE_ERROR","PANES_RESIZED","PANES_RESIZED_VERTICAL","FULLSCREEN_TOGGLE","FULLSCREEN_EDITOR","FULLSCREEN_CONSOLE","FULLSCREEN_EXIT","LIBRARY_MANAGER_OPEN","LIBRARY_ADD","LIBRARY_ADDED","LIBRARY_REMOVE","LIBRARY_REMOVED","DOMAIN_TRUST_REQUEST","DOMAIN_ADDED","DOMAIN_REMOVED","LIBRARIES_CLEARED","SHARE_SUCCESS","SHARE_ERROR","DESTROY","STATUS_MESSAGES","executing","completed","timeout","reset","cleared","CRYPTO_ARRAY_SIZE","TEMPLATE_MARKERS","SECRET","USER_CODE","DYNAMIC_CSP","LIBRARY_SCRIPTS","EDITOR_THEMES","ACE","value","label","CODEMIRROR","TEXTAREA","loggingManager","constructor","this","allowedComponents","Set","globalEnabled","allowAll","loadFromStorage","enable","components","forEach","add","comp","toLowerCase","saveToStorage","console","log","join","disable","delete","enableAll","disableAll","clear","status","Array","from","listComponents","registeredComponents","sort","enabled","isComponentEnabled","component","has","registerComponent","state","localStorage","setItem","JSON","stringify","e","parse","getItem","logFilter","list","Logger","options","level","prefix","redactSecrets","currentLevel","toUpperCase","shouldLog","componentAllowed","redactArgs","args","map","arg","replace","formatMessage","message","error","warn","info","debug","trace","wasRedacting","table","data","columns","group","groupCollapsed","groupEnd","time","timeEnd","setLevel","isEnabled","EditorAdapter","container","eventEmitter","changeHandlers","executeHandlers","inputHandlers","deleteHandlers","logger","on","onThemeChange","theme","oldTheme","getValue","Error","setValue","code","onChange","callback","push","onExecute","onInput","onDelete","focus","triggerChange","handler","triggerExecute","triggerInput","inputData","triggerDelete","deleteData","applyTransformation","transformation","newTheme","destroy","AdvancedAutocomplete","cm","scopeVariables","Map","loadedLibraries","initScopeTracking","analyzeScopeVariables","Object","entries","variables","functions","classes","arrowFunctions","type","pattern","match","exec","name","set","line","getLineNumber","index","extractValue","size","text","substring","split","length","startIndex","trim","provideHints","cursor","getCursor","token","getTokenAt","getLine","start","end","ch","suggestions","endsWith","startsWith","string","displayText","className","hint","replaceRange","objMatch","objName","objInfo","get","getPropertySuggestions","CodeMirror","Pos","to","method","InputManager","bracketPairs","handleInput","char","position","closeChar","shouldAutoClose","action","cursorOffset","values","charAt","positions","handleDelete","charBefore","charAfter","open","close","test","getDebugInfo","lineLength","nearContext","Math","max","CodeMirrorEditor","super","currentTheme","inputManager","init","setupInputHandling","textarea","createElement","appendChild","fromTextArea","mode","lineNumbers","lineWrapping","indentUnit","tabSize","indentWithTabs","autofocus","extraKeys","autocomplete","setupAutocomplete","applyGlassEffect","setOption","getOption","setTimeout","cmElement","backgroundColor","getComputedStyle","reducedOpacityColor","reduceColorOpacity","styleElement","getElementById","id","head","themeClass","textContent","color","opacity","rgbaMatch","r","g","b","rgbMatch","hexMatch","parseInt","getCurrentTheme","setTheme","autocompleteSetup","advancedAutocomplete","jsKeywords","browserGlobals","getObjectMethods","obj","prototype","methods","getOwnPropertyNames","currentProto","getPrototypeOf","consoleMethods","windowMethods","Window","documentMethods","Document","arrayMethods","stringMethods","String","mathMethods","methodCache","Storage","sessionStorage","navigator","Navigator","Location","javascriptHint","currentWord","fullTextToCursor","dotMatch","objectName","partialMethod","allMethods","filter","slice","textBefore","globalObj","allSuggestions","userVariables","keys","item","replaceStart","replaceEnd","lastIndexOf","render","element","self","registerHelper","existingKeys","replaceSelection","execCommand","change","setAdvancedInstance","instance","lineNumber","origin","newCursor","setCursor","toTextArea"],"mappings":"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"}